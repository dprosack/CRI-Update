{"remainingRequest":"C:\\Users\\DPROSACK\\Documents\\GitHub\\CRI-Update\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\DPROSACK\\Documents\\GitHub\\CRI-Update\\node_modules\\eslint-loader\\index.js??ref--14-0!C:\\Users\\DPROSACK\\Documents\\GitHub\\CRI-Update\\src\\plugins\\fmeserver.js","dependencies":[{"path":"C:\\Users\\DPROSACK\\Documents\\GitHub\\CRI-Update\\src\\plugins\\fmeserver.js","mtime":1640977540806},{"path":"C:\\Users\\DPROSACK\\Documents\\GitHub\\CRI-Update\\babel.config.js","mtime":1639609171225},{"path":"C:\\Users\\DPROSACK\\Documents\\GitHub\\CRI-Update\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\DPROSACK\\Documents\\GitHub\\CRI-Update\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\DPROSACK\\Documents\\GitHub\\CRI-Update\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90eXBlb2YgPSByZXF1aXJlKCJDOlxcVXNlcnNcXERQUk9TQUNLXFxEb2N1bWVudHNcXEdpdEh1YlxcQ1JJLVVwZGF0ZVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWVcXGhlbHBlcnNcXHR5cGVvZi5qcyIpLmRlZmF1bHQ7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmpzb24uc3RyaW5naWZ5LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uLmpzIik7CgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioNCiAqIEZNRVNlcnZlci5qcw0KICogMjAxOCBTYWZlIFNvZnR3YXJlDQogKiBzdXBwb3J0QHNhZmUuY29tDQogKg0KICogVW5vZmZpY2lhbCBKYXZhU2NyaXB0IExpYnJhcnkgZm9yIEZNRSBTZXJ2ZXIgPj0gMjAxNC4gVGhpcyBpcyBub3QgaW50ZW5kZWQgdG8NCiAqIGJlIGEgY29tcGxldGUgQVBJLCBidXQgcmF0aGVyIGEgY29sbGVjdGlvbiBvZiBib2lsZXJwbGF0ZSBtZXRob2RzDQogKiBmb3IgUkVTVCBBUEkgY2FsbHMgdHlwaWNhbGx5IG5lZWRlZCBpbiBhIHdlYiBwYWdlDQogKiBpbnRlcmZhY2luZyB3aXRoIEZNRSBTZXJ2ZXIuDQogKg0KICogVGhlIE1JVCBMaWNlbnNlIChNSVQpDQogKg0KICogQ29weXJpZ2h0IChjKSAyMDE4IFNhZmUgU29mdHdhcmUNCiAqDQogKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5DQogKiBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbA0KICogaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cw0KICogdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbA0KICogY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzDQogKiBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOg0KICoNCiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluDQogKiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS4NCiAqDQogKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUg0KICogSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksDQogKiBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUNCiAqIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVINCiAqIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sDQogKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElODQogKiBUSEUgU09GVFdBUkUuDQogKg0KICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKLyoqDQogKiBGTUUgU2VydmVyIExpYnJhcnkNCiAqIEBhdXRob3IgU2FmZSBTb2Z0d2FyZQ0KICogQHZlcnNpb24gMw0KICogQHRoaXMgRk1FU2VydmVyDQogKiBAcmV0dXJuIHtGTUVTZXJ2ZXJ9IGZtZSAtIEZNRSBTZXJ2ZXIgY29ubmVjdGlvbiBvYmplY3QNCiAqLwp2YXIgRk1FU2VydmVyID0gZnVuY3Rpb24gKCkgewogIC8qKg0KICAgKiBBZGQgaW5kZXhPZiBhbmQgdHJpbSBtZXRob2QgZm9yIFN0cmluZ3MgYW5kIEFycmF5J3MgaW4gb2xkZXIgYnJvd3NlcnMNCiAgICovCiAgaWYgKCFBcnJheS5wcm90b3R5cGUuaW5kZXhPZikgewogICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAob2JqLCBzdGFydCkgewogICAgICBmb3IgKHZhciBpID0gc3RhcnQgfHwgMCwgaiA9IHRoaXMubGVuZ3RoOyBpIDwgajsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXNbaV0gPT09IG9iaikgewogICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gLTE7CiAgICB9OwogIH0KCiAgaWYgKHR5cGVvZiBTdHJpbmcucHJvdG90eXBlLnRyaW0gIT09ICdmdW5jdGlvbicpIHsKICAgIFN0cmluZy5wcm90b3R5cGUudHJpbSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMucmVwbGFjZSgvXlxzK3xccyskL2csICcnKTsKICAgIH07CiAgfQogIC8qKg0KICAgKiBDb25maWd1cmF0aW9uIG9iamVjdCwgaG9sZHMgaW5zdGFuY2UgY29uZmlndXJhdGlvbg0KICAgKi8KCgogIHZhciBjb25maWcgPSB7CiAgICB2ZXJzaW9uOiAndjMnCiAgfTsKICAvKioNCiAgICogR2V0IENvbmZpZ3VyYXRpb24gTWV0aG9kDQogICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gTmFtZSBvZiBzZXR0aW5nDQogICAqIEByZXR1cm4ge1N0cmluZ30gLSBpbmRpdmlkdWFsIHBhcmFtZXRlciwgb3Ige09iamVjdH0gLSBjb25maWcNCiAgICovCgogIGZ1bmN0aW9uIGdldENvbmZpZyhwYXJhbSkgewogICAgcGFyYW0gPSBwYXJhbSB8fCBudWxsOwoKICAgIGlmIChwYXJhbSkgewogICAgICByZXR1cm4gY29uZmlnW3BhcmFtXTsKICAgIH0KCiAgICByZXR1cm4gY29uZmlnOwogIH0KICAvKioNCiAgICogR2V0IFNpbXBsZSBSZXNwb25zZSBUeXBlDQogICAqIEByZXR1cm4ge1N0cmluZ30gLSBUaGUgZXh0cmFjdGVkIHNpbXBsZSBhY2NlcHQgdHlwZSBmcm9tIHRoZSBjb25maWcNCiAgICovCgoKICBmdW5jdGlvbiBnZXRSZXNwb25zZVR5cGUoKSB7CiAgICB2YXIgdHlwZSA9IGdldENvbmZpZygnYWNjZXB0JyksCiAgICAgICAgYWNjZXB0ID0gJ2pzb24nOwoKICAgIGlmICh0eXBlLmluZGV4T2YoJy8nKSAhPT0gLTEpIHsKICAgICAgdHlwZSA9IHR5cGUuc3BsaXQoL1wvL2cpOwoKICAgICAgaWYgKHR5cGVbMV0ubGVuZ3RoID4gMCkgewogICAgICAgIGFjY2VwdCA9IHR5cGVbMV07CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gYWNjZXB0OwogIH0KICAvKioNCiAgICogQ2hlY2sgQ29uZmlnIFN0YXR1cw0KICAgKi8KCgogIGZ1bmN0aW9uIGNoZWNrQ29uZmlnKCkgewogICAgaWYgKGdldENvbmZpZygnc2VydmVyJykgJiYgZ2V0Q29uZmlnKCd0b2tlbicpKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgaW5pdGlhbGl6ZSBGTUVTZXJ2ZXIgdXNpbmcgdGhlIEZNRVNlcnZlci5pbml0KCkgbWV0aG9kLicpOwogIH0KICAvKioNCiAgICogQUpBWCBNZXRob2QNCiAgICogQHBhcmFtIHtTdHJpbmd9IHVybCAtIFRoZSByZXF1ZXN0IFVSTA0KICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyBqc29uIHJlc3BvbnNlDQogICAqIEBwYXJhbSB7U3RyaW5nfSBydHlwIC0gVHlwZSBvZiByZXF1ZXN0IGV4OiBQVVQsIEdFVChEZWZhdWx0KQ0KICAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1zIC0gVGhlIGpzb24gb3IgbmFtZT12YWx1ZSBwYWlyIHN0cmluZyBvciBwYXJhbWV0ZXJzDQogICAqIEBwYXJhbSB7U3RyaW5nfSBjdHlwIC0gQ29udGVudCB0eXBlIGFzIGEgc3RyaW5nIChvcHRpb25hbCkNCiAgICogQHBhcmFtIHtTdHJpbmd9IGF0eXAgLSBBY2NlcHQgdHlwZSBhcyBhIHN0cmluZyAob3B0aW9uYWwpDQogICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ1BPU1QnLCBwYXJhbXMsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTsNCiAgICAgKi8KCgogIGZ1bmN0aW9uIGFqYXgodXJsLCBjYWxsYmFjaywgcnR5cCwgcGFyYW1zLCBjdHlwLCBhdHlwKSB7CiAgICBpZiAoY2hlY2tDb25maWcoKSkgewogICAgICBpZiAoY2FsbGJhY2sgPT09IG51bGwgfHwgdHlwZW9mIGNhbGxiYWNrICE9ICdmdW5jdGlvbicpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgY2FsbGJhY2sgZnVuY3Rpb24gbXVzdCBiZSBkZWZpbmVkIGluIG9yZGVyIHRvIHVzZSB0aGUgRk1FIFNlcnZlciBSRVNUIEFQSS4nKTsKICAgICAgfQoKICAgICAgdmFyIHJlcTsKICAgICAgcnR5cCA9IHJ0eXAgfHwgJ0dFVCc7CiAgICAgIHBhcmFtcyA9IHBhcmFtcyB8fCBudWxsOwogICAgICBjdHlwID0gY3R5cCB8fCBudWxsOwogICAgICBhdHlwID0gYXR5cCB8fCBnZXRDb25maWcoJ2FjY2VwdCcpOwoKICAgICAgaWYgKHVybC5pbmRleE9mKCc/JykgIT0gLTEpIHsKICAgICAgICB1cmwgKz0gJyZkZXRhaWw9JyArIGdldENvbmZpZygnZGV0YWlsJyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdXJsICs9ICc/ZGV0YWlsPScgKyBnZXRDb25maWcoJ2RldGFpbCcpOwogICAgICB9CgogICAgICBpZiAoZ2V0Q29uZmlnKCd4ZG9tYWluJykpIHsKICAgICAgICBpZiAocnR5cCA9PSAnR0VUJykgewogICAgICAgICAgcmVxID0gbmV3IFhEb21haW5SZXF1ZXN0KCk7CiAgICAgICAgICB1cmwgKz0gJyZ0b2tlbj0nICsgZ2V0Q29uZmlnKCd0b2tlbicpOwogICAgICAgICAgcmVxLm9wZW4ocnR5cCwgdXJsKTsKCiAgICAgICAgICByZXEub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgcmVzcDsKICAgICAgICAgICAgcmVzcCA9IHJlcS5yZXNwb25zZVRleHQ7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJlc3AgPSBKU09OLnBhcnNlKHJlc3ApOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7Ly8gTm90IGEgSlNPTiByZXNwb25zZQogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIGNhbGxiYWNrKHJlc3ApOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwoKICAgICAgICAgIHJlcS5zZW5kKCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSUU4IGFuZCBJRTkgT25seSBzdXBwb3J0IENPUlMgcmVxdWVzdHMgdGhyb3VnaCBHRVQgbWV0aG9kcy4gT25seSBwYXJ0aWFsIGZ1bmN0aW9uYWxpdHkgaXMgYXZhaWxhYmxlLicpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICByZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgICByZXEub3BlbihydHlwLCB1cmwsIHRydWUpOwogICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdBdXRob3JpemF0aW9uJywgJ2ZtZXRva2VuIHRva2VuPScgKyBnZXRDb25maWcoJ3Rva2VuJykpOwoKICAgICAgICBpZiAoYXR5cCAhPT0gbnVsbCkgewogICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsIGF0eXApOwogICAgICAgIH0KCiAgICAgICAgaWYgKGN0eXAgIT09IG51bGwgJiYgY3R5cCAhPSAnYXR0YWNobWVudCcpIHsKICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LXR5cGUnLCBjdHlwKTsKICAgICAgICB9CgogICAgICAgIGlmIChjdHlwID09ICdhdHRhY2htZW50JykgewogICAgICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0nKTsKICAgICAgICAgIHJlcS5zZXRSZXF1ZXN0SGVhZGVyKCdDb250ZW50LURpc3Bvc2l0aW9uJywgJ2F0dGFjaG1lbnQ7IGZpbGVuYW1lPSInICsgcGFyYW1zLm5hbWUgKyAnIicpOwogICAgICAgICAgcGFyYW1zID0gcGFyYW1zLmNvbnRlbnRzOwogICAgICAgIH0KCiAgICAgICAgcmVxLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBkb25lID0gNDsKCiAgICAgICAgICBpZiAocmVxLnJlYWR5U3RhdGUgPT0gZG9uZSkgewogICAgICAgICAgICB2YXIgcmVzcDsKCiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgcmVzcCA9IHJlcS5yZXNwb25zZVRleHQ7CgogICAgICAgICAgICAgIGlmIChyZXNwLmxlbmd0aCA9PT0gMCAmJiByZXEuc3RhdHVzID09IDIwNCkgewogICAgICAgICAgICAgICAgcmVzcCA9ICd7ICJkZWxldGUiIDogInRydWUiIH0nOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzcC5sZW5ndGggPT09IDAgJiYgcmVxLnN0YXR1cyA9PSAyMDIpIHsKICAgICAgICAgICAgICAgIHJlc3AgPSAneyAidmFsdWUiIDogInRydWUiIH0nOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgcmVzcCA9IEpTT04ucGFyc2UocmVzcCk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICByZXNwID0gcmVxLnJlc3BvbnNlOwogICAgICAgICAgICB9IGZpbmFsbHkgewogICAgICAgICAgICAgIGNhbGxiYWNrKHJlc3ApOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfTsKCiAgICAgICAgcmVxLnNlbmQocGFyYW1zKTsKICAgICAgfQogICAgfQogIH0KICAvKioNCiAgICogQnVpbGQgVVJMIGZyb20gY29uZmlnIE1ldGhvZC4NCiAgICogQHBhcmFtIHtTdHJpbmd9IHVybCAtIFVSTCB3aXRoIHBsYWNlaG9sZGVycw0KICAgKiBAcmV0dXJuIHtTdHJpbmd9IHVybCAtIFRoZSByZXN1bHQgdXJsDQogICAqLwoKCiAgZnVuY3Rpb24gYnVpbGRVUkwodXJsKSB7CiAgICB1cmwgPSB1cmwucmVwbGFjZSgve3tzdnJ9fS9nLCBnZXRDb25maWcoJ3NlcnZlcicpKTsKICAgIHVybCA9IHVybC5yZXBsYWNlKC97e3Zlcn19L2csIGdldENvbmZpZygndmVyc2lvbicpKTsKICAgIHJldHVybiB1cmw7CiAgfSAvLyBUaGUgRk1FIFNlcnZlciBDb25uZWN0aW9uIE9iamVjdAoKCiAgdmFyIGZtZSA9IHsKICAgIC8qKg0KICAgICAqIEluaXRpYWxpemUgdGhlIEZNRSBTZXJ2ZXIgY29ubmVjdGlvbiBvYmplY3QNCiAgICAgKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIC0gVGhlIG9iamVjdCBob2xkaW5nIHRoZSBjb25maWd1cmF0aW9uDQogICAgICogICAgICB7IHNlcnZlciA6IHNlcnZlcl91cmwsDQogICAgICogICAgICAgIHRva2VuIDogdG9rZW5fc3RyaW5nLA0KICAgICAqICAgICAgICBmb3JtYXQgOiBqc29uX3htbF9vcl9odHRwLA0KICAgICAqICAgICAgICBkZXRhaWwgOiBoaWdoX29yX2xvdywNCiAgICAgKiAgICAgICAgcG9ydCA6IHBvcnRfbnVtYmVyX3N0cmluZywNCiAgICAgKiAgICAgICAgc3NsIDogdHJ1ZV9vcl9mYWxzZQ0KICAgICAqICAgICAgfQ0KICAgICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tIE9SOiBMRUdBQ1kgUEFSQU1FVEVSUyBCRUxPVyAtLS0tLS0tLS0tLS0tLS0tLS0tLQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBzZXJ2ZXIgLSBTZXJ2ZXIgVVJMDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHRva2VuIC0gT2J0YWluZWQgZnJvbSBodHRwOi8veW91cmZtZXNlcnZlci9mbWV0b2tlbg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBmb3JtYXQgLSBPdXRwdXQgZm9ybWF0IGRlc2lyZWQsIGpzb24gKGRlZmF1bHQpLCB4bWwsIG9yIGh0bWwNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGV0YWlsIC0gaGlnaCAoZGVmYXVsdCkgb3IgbG93DQogICAgICogQHBhcmFtIHtOdW1iZXJ9IHBvcnQgLSBQb3J0LCBkZWZhdWx0IGlzIDgwIC0gc3RyaW5nDQogICAgICogQHBhcmFtIHtCb29sZWFufSBzc2wgLSBDb25uZWN0IHRvIHRoZSBzZXJ2ZXIgdmlhIEhUVFBTDQogICAgICovCiAgICBpbml0OiBmdW5jdGlvbiBpbml0KHNlcnZlciwgdG9rZW4sIGZvcm1hdCwgZGV0YWlsLCBwb3J0LCBzc2wpIHsKICAgICAgLyoqDQogICAgICAgKiBDaGVjayBmb3IgdGhlIHNlcnZlciB1cmwgYW5kIHRoZSB0b2tlbiBwYXJhbWV0ZXJzIC0gcmVxdWlyZWQgZm9yIGNvbm5lY3Rpb24NCiAgICAgICAqIEByZXR1cm4gbnVsbCAtIGlmIG5vdCB2YWxpZA0KICAgICAgICovCiAgICAgIGlmIChzZXJ2ZXIgPT09IHVuZGVmaW5lZCB8fCBfdHlwZW9mKHNlcnZlcikgPT09ICdvYmplY3QnICYmIHNlcnZlci5zZXJ2ZXIgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IGRpZCBub3Qgc3BlY2lmeSBhIHNlcnZlciBVUkwgaW4geW91ciBjb25maWd1cmF0aW9uIHBhcmFtZXRlcnMuJyk7CiAgICAgIH0gZWxzZSBpZiAodG9rZW4gPT09IHVuZGVmaW5lZCAmJiBfdHlwZW9mKHNlcnZlcikgPT09ICdvYmplY3QnICYmIHNlcnZlci50b2tlbiA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgZGlkIG5vdCBzcGVjaWZ5IGEgdG9rZW4gaW4geW91ciBjb25maWd1cmF0aW9uIHBhcmFtZXRlcnMuJyk7CiAgICAgIH0KICAgICAgLyoqDQogICAgICAgKiBDaGVjayBmb3IgU3RyaW5nIHBhcmFtYXRlcnMgdnMuIG9iamVjdCwgYW5kIGJ1aWxkIHRoZSBjb25maWd1cmF0aW9uDQogICAgICAgKi8KCgogICAgICBpZiAoX3R5cGVvZihzZXJ2ZXIpID09ICdvYmplY3QnKSB7CiAgICAgICAgZ2V0Q29uZmlnKCkuc2VydmVyID0gc2VydmVyLnNlcnZlcjsKICAgICAgICBnZXRDb25maWcoKS50b2tlbiA9IHNlcnZlci50b2tlbjsKICAgICAgICBnZXRDb25maWcoKS5hY2NlcHQgPSBzZXJ2ZXIuZm9ybWF0IHx8ICdhcHBsaWNhdGlvbi9qc29uJzsKICAgICAgICBnZXRDb25maWcoKS5kZXRhaWwgPSBzZXJ2ZXIuZGV0YWlsIHx8ICdoaWdoJzsKICAgICAgICBnZXRDb25maWcoKS5wb3J0ID0gc2VydmVyLnBvcnQgfHwgJzgwJzsKICAgICAgICBnZXRDb25maWcoKS5zc2wgPSBzZXJ2ZXIuc3NsIHx8IGZhbHNlOwogICAgICAgIGdldENvbmZpZygpLnhkb21haW4gPSBmYWxzZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBnZXRDb25maWcoKS5zZXJ2ZXIgPSBzZXJ2ZXI7CiAgICAgICAgZ2V0Q29uZmlnKCkudG9rZW4gPSB0b2tlbjsKICAgICAgICBnZXRDb25maWcoKS5hY2NlcHQgPSBmb3JtYXQgfHwgJ2FwcGxpY2F0aW9uL2pzb24nOwogICAgICAgIGdldENvbmZpZygpLmRldGFpbCA9IGRldGFpbCB8fCAnaGlnaCc7CiAgICAgICAgZ2V0Q29uZmlnKCkucG9ydCA9IHBvcnQgfHwgJzgwJzsKICAgICAgICBnZXRDb25maWcoKS5zc2wgPSBzc2wgfHwgZmFsc2U7CiAgICAgICAgZ2V0Q29uZmlnKCkueGRvbWFpbiA9IGZhbHNlOwogICAgICB9CiAgICAgIC8qKg0KICAgICAgICogUmVtb3ZlIHRyYWlsaW5nIHNsYXNoIGZyb20gc2V2ZXIgaWYgcHJlc2VudA0KICAgICAgICovCgoKICAgICAgaWYgKGdldENvbmZpZygnc2VydmVyJykuY2hhckF0KGdldENvbmZpZygnc2VydmVyJykubGVuZ3RoIC0gMSkgPT0gJy8nKSB7CiAgICAgICAgZ2V0Q29uZmlnKCkuc2VydmVyID0gZ2V0Q29uZmlnKCdzZXJ2ZXInKS5zdWJzdHIoMCwgZ2V0Q29uZmlnKCdzZXJ2ZXInKS5sZW5ndGggLSAxKTsKICAgICAgfQogICAgICAvKioNCiAgICAgICAqIENvbnZlcnRzIHNlcnZlciBob3N0IHRvIFVSTA0KICAgICAgICovCgoKICAgICAgaWYgKGdldENvbmZpZygnc2VydmVyJykuc3Vic3RyaW5nKDAsIDQpICE9ICdodHRwJykgewogICAgICAgIGdldENvbmZpZygpLnNlcnZlciA9ICdodHRwOi8vJyArIGdldENvbmZpZygnc2VydmVyJyk7CiAgICAgIH0KICAgICAgLyoqDQogICAgICAgKiBDaGFuZ2VzIGh0dHA6Ly8gdG8gaHR0cHM6Ly8gaWYgU1NMIGlzIHJlcXVpcmVkDQogICAgICAgKi8KCgogICAgICBpZiAoZ2V0Q29uZmlnKCdzc2wnKSkgewogICAgICAgIGdldENvbmZpZygpLnNlcnZlciA9IGdldENvbmZpZygnc2VydmVyJykucmVwbGFjZSgnaHR0cDovLycsICdodHRwczovLycpOwogICAgICB9CiAgICAgIC8qKg0KICAgICAgICogU2V0IElFOCAvIElFOSBDT1JTIG1vZGUgaWYgcmVxdWlyZWQNCiAgICAgICAqLwoKCiAgICAgIGlmIChsb2NhdGlvbi5ob3N0ICE9IGdldENvbmZpZygnc2VydmVyJykuc3BsaXQoJy8vJylbMV0uc3BsaXQoJy8nKVswXSAmJiBuYXZpZ2F0b3IuYXBwTmFtZSA9PSAnTWljcm9zb2Z0IEludGVybmV0IEV4cGxvcmVyJyAmJiAobmF2aWdhdG9yLmFwcFZlcnNpb24uaW5kZXhPZignTVNJRSA5JykgIT09IC0xIHx8IG5hdmlnYXRvci5hcHBWZXJzaW9uLmluZGV4T2YoJ01TSUUgOCcpICE9PSAtMSkpIHsKICAgICAgICBnZXRDb25maWcoKS54ZG9tYWluID0gdHJ1ZTsKICAgICAgfQogICAgICAvKioNCiAgICAgICAqIEF0dGFjaGVzIHBvcnQgdG8gc2VydmVyIFVSTCBpZiBub3QgYSBzdGFuZGFyZCBwb3J0DQogICAgICAgKi8KCgogICAgICB2YXIgc3RkUG9ydHMgPSBbJzgwJywgJzQ0MyddOwoKICAgICAgaWYgKHN0ZFBvcnRzLmluZGV4T2YoZ2V0Q29uZmlnKCdwb3J0JykpID09PSAtMSkgewogICAgICAgIGdldENvbmZpZygpLnNlcnZlciA9IGdldENvbmZpZygnc2VydmVyJykgKyAnOicgKyBnZXRDb25maWcoJ3BvcnQnKTsKICAgICAgfQogICAgfSwKCiAgICAvKioNCiAgICAgKiBHZXRzIHRoZSBjdXJyZW50IHNlc3Npb24gZnJvbSBGTUUgU2VydmVyLiBZb3UgY2FuIHVzZSB0aGlzIHRvIGdldCB0aGUgcGF0aCB0byBhbnkNCiAgICAgKiBmaWxlcyBhZGRlZCB0aHJvdWdoIHRoZSBmaWxlIHVwbG9hZCBzZXJ2aWNlLg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXBvc2l0b3J5IC0gVGhlIHJlcG9zaXRvcnkgb24gdGhlIEZNRSBTZXJ2ZXINCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gd29ya3NwYWNlIC0gVGhlIG5hbWUgb2YgdGhlIHdvcmtzcGFjZSBvbiBGTUUgU2VydmVyLCBpLmUuIHdvcmtzcGFjZS5mbXcNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyBzZXNzaW9uSUQgYXMgYSBzdHJpbmcNCiAgICAgKi8KICAgIGdldFNlc3Npb246IGZ1bmN0aW9uIGdldFNlc3Npb24ocmVwb3NpdG9yeSwgd29ya3NwYWNlLCBjYWxsYmFjaykgewogICAgICB2YXIgbWluID0gMTsKICAgICAgdmFyIG1heCA9IDEwMDAwMDAwMDA7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZWRhdGF1cGxvYWQvJyArIHJlcG9zaXRvcnkgKyAnLycgKyB3b3Jrc3BhY2UpOwogICAgICB2YXIgcGFyYW1zID0gJ29wdF9leHRyYWN0YXJjaGl2ZT1mYWxzZSZvcHRfcGF0aGxldmVsPTMmb3B0X2Z1bGxwYXRoPXRydWUmdG9rZW49JyArIGdldENvbmZpZygndG9rZW4nKSArICcmb3B0X25hbWVzcGFjZT0nICsgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrLCAnUE9TVCcsIHBhcmFtcywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBSZXR1cm5zIGEgV2ViU29ja2V0IGNvbm5lY3Rpb24gdG8gdGhlIHNwZWNpZmllZCBzZXJ2ZXINCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWQgLSBBIG5hbWUgZm9yIHRoZSBkZXNpcmVkIFdlYlNvY2tldCBzdHJlYW0gaWQNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIHRvIHJ1biBhZnRlciBjb25uZWN0aW9uIGlzIG9wZW5lZCAob3B0aW9uYWwpDQogICAgICogQHJldHVybiB7V2ViU29ja2V0fSB3cyAtIEEgV2ViU29ja2V0IGNvbm5lY3Rpb24NCiAgICAgKi8KICAgIGdldFdlYlNvY2tldENvbm5lY3Rpb246IGZ1bmN0aW9uIGdldFdlYlNvY2tldENvbm5lY3Rpb24oaWQsIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybDsKCiAgICAgIGlmIChnZXRDb25maWcoJ3NlcnZlcicpLmluZGV4T2YoJ2h0dHBzOi8vJykgIT0gLTEpIHsKICAgICAgICB1cmwgPSBnZXRDb25maWcoJ3NlcnZlcicpLnJlcGxhY2UoJ2h0dHBzOi8vJywgJ3dzczovLycpOwogICAgICB9IGVsc2UgewogICAgICAgIHVybCA9IGdldENvbmZpZygnc2VydmVyJykucmVwbGFjZSgnaHR0cDovLycsICd3czovLycpOwogICAgICB9CgogICAgICB2YXIgd3MgPSBuZXcgV2ViU29ja2V0KHVybCArICc6NzA3OC93ZWJzb2NrZXQnKTsKCiAgICAgIHdzLm9ub3BlbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgb3Blbk1zZyA9IHsKICAgICAgICAgIHdzX29wOiAnb3BlbicsCiAgICAgICAgICB3c19zdHJlYW1faWQ6IGlkCiAgICAgICAgfTsKICAgICAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KG9wZW5Nc2cpKTsKCiAgICAgICAgaWYgKGNhbGxiYWNrICE9PSBudWxsKSB7CiAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgIH0KICAgICAgfTsKCiAgICAgIHJldHVybiB3czsKICAgIH0sCgogICAgLyoqDQogICAgICogUnVucyBhIHdvcmtzcGFjZSB1c2luZyB0aGUgRGF0YSBEb3dubG9hZCBzZXJ2aWNlIGFuZCByZXR1cm5zIGpzb24NCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcmVwb3NpdG9yeSAtIFRoZSByZXBvc2l0b3J5IG9uIEZNRSBTZXJ2ZXINCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gd29ya3NwYWNlIC0gVGhlIG5hbWUgb2YgdGhlIHdvcmtzcGFjZSBvbiBGTUUgU2VydmVyLCBpLmUuIHdvcmtzcGFjZS5mbXcNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1zIC0gQW55IHdvcmtzcGFjZS1zcGVjaWZpYyBwYXJhbWV0ZXIgdmFsdWVzIGFzIGEgVVJMIGVuY29kZWQgc3RyaW5nIGkuZS4gcGFyYW0xPXZhbHVlMSZwYXJhbTI9dmFsdWUyDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBydW5EYXRhRG93bmxvYWQ6IGZ1bmN0aW9uIHJ1bkRhdGFEb3dubG9hZChyZXBvc2l0b3J5LCB3b3Jrc3BhY2UsIHBhcmFtcywgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lZGF0YWRvd25sb2FkLycgKyByZXBvc2l0b3J5ICsgJy8nICsgd29ya3NwYWNlKTsKCiAgICAgIGlmIChwYXJhbXMgJiYgcGFyYW1zLmxlbmd0aCA+IDApIHsKICAgICAgICBwYXJhbXMgPSAnJicgKyBwYXJhbXM7CiAgICAgIH0KCiAgICAgIHBhcmFtcyA9ICdvcHRfcmVzcG9uc2Vmb3JtYXQ9JyArIGdldFJlc3BvbnNlVHlwZSgpICsgJyZvcHRfc2hvd3Jlc3VsdD10cnVlJnRva2VuPScgKyBnZXRDb25maWcoJ3Rva2VuJykgKyBwYXJhbXM7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ1BPU1QnLCBwYXJhbXMsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTsKICAgIH0sCgogICAgLyoqDQogICAgICogUnVucyBhIHdvcmtzcGFjZSB1c2luZyB0aGUgRGF0YSBTdHJlYW1pbmcgc2VydmljZSBhbmQgcmV0dXJucyB0aGUgd29ya3NwYWNlIG91dHB1dA0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXBvc2l0b3J5IC0gVGhlIHJlcG9zaXRvcnkgb24gRk1FIFNlcnZlcg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSB3b3Jrc3BhY2UgLSBUaGUgbmFtZSBvZiB0aGUgd29ya3NwYWNlIG9uIEZNRSBTZXJ2ZXIsIGkuZS4gd29ya3NwYWNlLmZtdw0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwYXJhbXMgLSBBbnkgd29ya3NwYWNlLXNwZWNpZmljIHBhcmFtZXRlciB2YWx1ZXMgYXMgYSBVUkwgZW5jb2RlZCBzdHJpbmcgaS5lLiBwYXJhbTE9dmFsdWUxJnBhcmFtMj12YWx1ZTINCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUgd29ya3NwYWNlIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgcnVuRGF0YVN0cmVhbWluZzogZnVuY3Rpb24gcnVuRGF0YVN0cmVhbWluZyhyZXBvc2l0b3J5LCB3b3Jrc3BhY2UsIHBhcmFtcywgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lZGF0YXN0cmVhbWluZy8nICsgcmVwb3NpdG9yeSArICcvJyArIHdvcmtzcGFjZSk7CiAgICAgIHBhcmFtcyA9ICdvcHRfc2hvd3Jlc3VsdD10cnVlJnRva2VuPScgKyBnZXRDb25maWcoJ3Rva2VuJykgKyAnJicgKyBwYXJhbXM7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ1BPU1QnLCBwYXJhbXMsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTsKICAgIH0sCgogICAgLyoqDQogICAgICogVXBsb2FkIGZpbGUocykgdXNpbmcgZGF0YSB1cGxvYWQgc2VydmljZQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXBvc2l0b3J5IC0gVGhlIHJlcG9zaXRvcnkgb24gRk1FIFNlcnZlcg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSB3b3Jrc3BhY2UgLSBUaGUgbmFtZSBvZiB0aGUgd29ya3NwYWNlIG9uIEZNRSBTZXJ2ZXIsIGkuZS4gd29ya3NwYWNlLmZtdw0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBmaWxlcyAtIFRoZSBmb3JtIGZpbGUgb2JqZWN0DQogICAgICogQHBhcmFtIHtTdHJpbmd9IGpzaWQgLSBUaGUgY3VycmVudCBzZXNzaW9uIGlkDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBkYXRhVXBsb2FkOiBmdW5jdGlvbiBkYXRhVXBsb2FkKHJlcG9zaXRvcnksIHdvcmtzcGFjZSwgZmlsZXMsIGpzaWQsIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAganNpZCA9IGpzaWQgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZWRhdGF1cGxvYWQvJyArIHJlcG9zaXRvcnkgKyAnLycgKyB3b3Jrc3BhY2UpOwogICAgICB2YXIgdG9rZW4gPSBnZXRDb25maWcoJ3Rva2VuJyk7CgogICAgICBpZiAoanNpZCAhPT0gbnVsbCkgewogICAgICAgIHVybCArPSAnP29wdF9uYW1lc3BhY2U9JyArIGpzaWQ7CiAgICAgICAgdXJsICs9ICcmb3B0X2Z1bGxwYXRoPXRydWUnOwogICAgICAgIHVybCArPSAnJnRva2VuPScgKyB0b2tlbjsKICAgICAgfSBlbHNlIHsKICAgICAgICB1cmwgKz0gJz90b2tlbj0nICsgdG9rZW47CiAgICAgICAgdXJsICs9ICcmb3B0X2Z1bGxwYXRoPXRydWUnOwogICAgICB9CgogICAgICBpZiAoIUZvcm1EYXRhKSB7CiAgICAgICAgLy8gSUU5IGFuZCBPbGRlciBCcm93c2VycyB0aGF0IGRvbid0IHN1cHBvcnQgRm9ybURhdGEKICAgICAgICAvLyBSYW5kb20gbnVtYmVyIGZvciBmb3JtIGFuZCBmcmFtZSBpZAogICAgICAgIHZhciByYW5kb20gPSBwYXJzZUludChNYXRoLnJhbmRvbSgpICogMTAwMDAwMDAwKTsgLy8gQ3JlYXRlIHRoZSBpbnZpc2libGUgaWZyYW1lIGZvciB0aGUgZm9ybSB0YXJnZXQKCiAgICAgICAgdmFyIGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOwogICAgICAgIGlmcmFtZS5pZCA9IHJhbmRvbSArICctZnJhbWUnOwogICAgICAgIGlmcmFtZS5uYW1lID0gcmFuZG9tOwogICAgICAgIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTsgLy8gQ3JlYXRlIHRoZSBmb3JtIHdpdGggdGhlIHByb3BlciBzZXR0aW5ncyBhbmQgc2V0IHRoZSB0YXJnZXQgdG8gdGhlIGlmcmFtZQoKICAgICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTsKICAgICAgICBmb3JtLmFjdGlvbiA9IHVybDsKICAgICAgICBmb3JtLm1ldGhvZCA9ICdQT1NUJzsKICAgICAgICBmb3JtLmVuY3R5cGUgPSAnbXVsdGlwYXJ0L2Zvcm0tZGF0YSc7IC8vIENsb25lIHRoZSBmaWxlIGlucHV0IGFuZCBzZXQgaXQncyBmaWxlcwoKICAgICAgICB2YXIgaW5wdXQgPSBmaWxlcy5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgICAgaW5wdXQubmFtZSA9ICJmaWxlc1tdIjsKICAgICAgICBpbnB1dC5maWxlcyA9IGZpbGVzLmZpbGVzOwogICAgICAgIGZvcm0uYXBwZW5kQ2hpbGQoaW5wdXQpOyAvLyBGaW5pc2ggc3R5bGluZyBhbmQgc3VibWl0IHRoZSBmb3JtCgogICAgICAgIGZvcm0udGFyZ2V0ID0gcmFuZG9tOwogICAgICAgIGZvcm0uaWQgPSByYW5kb20gKyAnLWZvcm0nOwogICAgICAgIGZvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGZvcm0pOwogICAgICAgIGZvcm0uc3VibWl0KCk7IC8vIFNlbmQgZmVlZGJhY2sgZm9yIGNsaWVudCBtZXRob2RzCgogICAgICAgIGNhbGxiYWNrKHsKICAgICAgICAgIHN1Ym1pdDogdHJ1ZSwKICAgICAgICAgIGlkOiByYW5kb20KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBOZXcgSFRNTDUgTWV0aG9kIGZvciBicm93c2VycyB0aGF0IHN1cHBvcnQgRm9ybURhdGEKICAgICAgICAvLyBDaHJvbWUgNyssIEZpcmVmb3ggNC4wICgyLjApLCBJRSAxMCssIE9wZXJhIDEyKywgU2FmYXJpIDUrCiAgICAgICAgdmFyIHBhcmFtcyA9IG5ldyBGb3JtRGF0YSgpOyAvLyBMb29wIHRocm91Z2gsIHN1cHBvcnQgZm9yIG11bHRpcGxlIGZpbGVzCgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZmlsZXMuZmlsZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHBhcmFtcy5hcHBlbmQoJ2ZpbGVzW10nLCBmaWxlcy5maWxlc1tpXSk7CiAgICAgICAgfQoKICAgICAgICB1cmwgPSB1cmw7CiAgICAgICAgYWpheCh1cmwsIGNhbGxiYWNrLCAnUE9TVCcsIHBhcmFtcyk7CiAgICAgIH0KICAgIH0sCgogICAgLyoqDQogICAgICogR2V0IGRhdGEgdXBsb2FkIGZpbGVzIGZvciB0aGUgc2Vzc2lvbg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXBvc2l0b3J5IC0gVGhlIHJlcG9zaXRvcnkgb24gRk1FIFNlcnZlcg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSB3b3Jrc3BhY2UgLSBUaGUgbmFtZSBvZiB0aGUgd29ya3NwYWNlIG9uIEZNRSBTZXJ2ZXIsIGkuZS4gd29ya3NwYWNlLmZtdw0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBqc2lkIC0gVGhlIGN1cnJlbnQgc2Vzc2lvbiBpZA0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgZ2V0RGF0YVVwbG9hZHM6IGZ1bmN0aW9uIGdldERhdGFVcGxvYWRzKHJlcG9zaXRvcnksIHdvcmtzcGFjZSwganNpZCwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICBqc2lkID0ganNpZCB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lZGF0YXVwbG9hZC8nICsgcmVwb3NpdG9yeSArICcvJyArIHdvcmtzcGFjZSk7CgogICAgICBpZiAoanNpZCAhPT0gbnVsbCkgewogICAgICAgIHVybCArPSAnP29wdF9uYW1lc3BhY2U9JyArIGpzaWQ7CiAgICAgICAgdXJsICs9ICcmb3B0X2Z1bGxwYXRoPXRydWUnOwogICAgICB9CgogICAgICBhamF4KHVybCwgY2FsbGJhY2spOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBSdW5zIGEgd29ya3NwYWNlIHdpdGggdXNlciB1cGxvYWRlZCBzZXNzaW9uIGRhdGENCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcmVwb3NpdG9yeSAtIFRoZSByZXBvc2l0b3J5IG9uIEZNRSBTZXJ2ZXINCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gd29ya3NwYWNlIC0gVGhlIG5hbWUgb2YgdGhlIHdvcmtzcGFjZSBvbiBGTUUgU2VydmVyLCBpLmUuIHdvcmtzcGFjZS5mbXcNCiAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIC0gVGhlIHBhcmFtZXRlciBvYmplY3QgZm9yIHJ1bm5pbmcgdGhlIHdvcmtzcGFjZSBzdHJ1Y3R1cmVkIGFzIGpzb24NCiAgICAgKiAgSXQgc2hvdWxkIGNvbnRhaW4gdGhlIGZvbGxvd2luZyBhdHRyaWJ1dGVzOg0KICAgIGZpbGVuYW1lIC0+IG5hbWUgb2YgdGhlIHNvdXJjZSBkYXRhc2V0IHBhcmFtZXRlciAtIGl0IGFzc3VtZXMgdGhlcmUncyBvbmx5IG9uZQ0KICAgIGZpbGVzIC0+IGEgbGlzdCBvZiBmaWxlIHBhdGhzIHRvIHBvaW50IHRoZSBzb3VyY2UgZGF0YXNldCBhdA0KICAgIGRlZmluZWQgbGlrZTogZmlsZXMgPSBbe3BhdGggOiAibXlwYXRoXGZpbGVuYW1lLnR4dCJ9LCB7cGF0aCA6ICJteXNlY29uZHBhdGhcZmlsZW5hbWUudHh0In1dDQogICAgY2FuIGNvbWUgZGlyZWN0bHkgZnJvbSB0aGUgcmVzcG9uc2UgZnJvbSB1cGxvYWRGaWxlIG9yIGdldERhdGFVcGxvYWRzDQogICAgICAgICAgICBzZXJ2aWNlIC0+IHRoZSBzZXJ2aWNlIHdpdGggd2hpY2ggdG8gcnVuIHRoZSB3b3Jrc3BhY2UgKGRhdGFkb3dubG9hZCwgam9ic3VibWl0dGVyLCBldGMpDQogICAgICAgICAgICBwYXJhbXMgLT4gKG9wdGlvbmFsKSBleHRyYSBwYXJhbWV0ZXJzIHRvIHNldCBpbiB0aGUgd29ya3NwYWNlIChzZXQgYXMgIlBBUkFNRVRFUk5BTUU9VkFMVUUmT1RIRVJQQVJBTT1PVEhFUlZBTFVFIikNCiAgICAgICAgaS5lLiBpdCBjYW4gYmUgZGVmaW5lZCBhczoNCiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7DQogICAgICAgICAgICAgICAgZmlsZW5hbWUgOiAnU291cmNlRGF0YXNldF9HRU5FUklDJywNCiAgICAgICAgICAgICAgICBmaWxlcyA6IHVwbG9hZGVkRmlsZXMsDQogICAgICAgICAgICAgICAgc2VydmljZSA6ICdmbWVqb2JzdWJtaXR0ZXInLA0KICAgICAgICAgICAgICAgIHBhcmFtcyA6ICJEZXN0aW5hdGlvbkZvcm1hdD1PR0NLTUwiDQogICAgICAgICAgICB9DQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBydW5Xb3Jrc3BhY2VXaXRoRGF0YTogZnVuY3Rpb24gcnVuV29ya3NwYWNlV2l0aERhdGEocmVwb3NpdG9yeSwgd29ya3NwYWNlLCBwYXJhbXMsIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHNlcnZpY2UgPSBwYXJhbXMuc2VydmljZSB8fCAnZm1lZGF0YWRvd25sb2FkJzsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19LycgKyBzZXJ2aWNlICsgJy8nICsgcmVwb3NpdG9yeSArICcvJyArIHdvcmtzcGFjZSArICc/Jyk7CiAgICAgIHZhciBmaWxlcyA9IHBhcmFtcy5maWxlczsKICAgICAgdmFyIGV4dHJhID0gcGFyYW1zLnBhcmFtczsKICAgICAgcGFyYW1zID0gcGFyYW1zLmZpbGVuYW1lICsgJz0lMjIlMjInOwoKICAgICAgZm9yICh2YXIgZiBpbiBmaWxlcykgewogICAgICAgIHBhcmFtcyArPSBmaWxlc1tmXS5wYXRoICsgJyUyMiUyMCUyMic7CiAgICAgIH0KCiAgICAgIGlmIChleHRyYSkgewogICAgICAgIHBhcmFtcyArPSAnJicgKyBleHRyYTsKICAgICAgfQoKICAgICAgOwogICAgICBwYXJhbXMgKz0gJyZvcHRfcmVzcG9uc2Vmb3JtYXQ9JyArIGdldFJlc3BvbnNlVHlwZSgpICsgJyZ0b2tlbj0nICsgZ2V0Q29uZmlnKCd0b2tlbicpOwogICAgICBhamF4KHVybCArIHBhcmFtcywgY2FsbGJhY2spOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBSZXRyaWV2ZXMgYWxsIGF2YWlsYWJsZSBSZXBvc2l0b3JpZXMgb24gdGhlIEZNRSBTZXJ2ZXINCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIGdldFJlcG9zaXRvcmllczogZnVuY3Rpb24gZ2V0UmVwb3NpdG9yaWVzKGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9yZXBvc2l0b3JpZXMnKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrKTsKICAgIH0sCgogICAgLyoqDQogICAgICogUmV0cmlldmVzIGFsbCBpdGVtcyBvbiB0aGUgRk1FIFNlcnZlciBmb3IgYSBnaXZlbiBSZXBvc2l0b3J5DQogICAgICogQHBhcmFtIHtTdHJpbmd9IHJlcG9zaXRvcnkgLSBUaGUgcmVwb3NpdG9yeSBvbiBGTUUgU2VydmVyDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGUgLSBUaGUgc3BlY2lmaWMgdHlwZSBvZiBmaWxlIGl0ZW0gcmVxdWVzdGVkIChvcHRpb25hbCkNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIGdldFJlcG9zaXRvcnlJdGVtczogZnVuY3Rpb24gZ2V0UmVwb3NpdG9yeUl0ZW1zKHJlcG9zaXRvcnksIGNhbGxiYWNrLCB0eXBlKSB7CiAgICAgIHR5cGUgPSB0eXBlIHx8ICcnOwogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vcmVwb3NpdG9yaWVzLycgKyByZXBvc2l0b3J5ICsgJy9pdGVtcz90eXBlPScgKyB0eXBlKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrKTsKICAgIH0sCgogICAgLyoqDQogICAgICogUmV0cmlldmVzIGFsbCBwdWJsaXNoZWQgcGFyYW1ldGVycyBmb3IgYSBnaXZlbiB3b3Jrc3BhY2UNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcmVwb3NpdG9yeSAtIFRoZSByZXBvc2l0b3J5IG9uIEZNRSBTZXJ2ZXINCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gd29ya3NwYWNlIC0gVGhlIG5hbWUgb2YgdGhlIHdvcmtzcGFjZSBvbiBGTUUgU2VydmVyLCBpLmUuIHdvcmtzcGFjZS5mbXcNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIGdldFdvcmtzcGFjZVBhcmFtZXRlcnM6IGZ1bmN0aW9uIGdldFdvcmtzcGFjZVBhcmFtZXRlcnMocmVwb3NpdG9yeSwgd29ya3NwYWNlLCBjYWxsYmFjaykgewogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vcmVwb3NpdG9yaWVzLycgKyByZXBvc2l0b3J5ICsgJy9pdGVtcy8nICsgd29ya3NwYWNlICsgJy9wYXJhbWV0ZXJzJyk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjayk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFJldHJpZXZlcyBhIHNpbmdsZSBwdWJsaXNoZWQgcGFyYW1ldGVyIGZvciBhIGdpdmVuIHdvcmtzcGFjZQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXBvc2l0b3J5IC0gVGhlIHJlcG9zaXRvcnkgdGhlIEZNRSBTZXJ2ZXINCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gd29ya3NwYWNlIC0gVGhlIG5hbWUgb2YgdGhlIHdvcmtzcGFjZSBvbiBGTUUgU2VydmVyLCBpLmUuIHdvcmtzcGFjZS5mbXcNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1ldGVyIC0gVGhlIG5hbWUgb2YgdGhlIHdvcmtzcGFjZSBwYXJhbWV0ZXINCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIHF1ZXJ5V29ya3NwYWNlUGFyYW1ldGVyOiBmdW5jdGlvbiBxdWVyeVdvcmtzcGFjZVBhcmFtZXRlcihyZXBvc2l0b3J5LCB3b3Jrc3BhY2UsIHBhcmFtZXRlciwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L3JlcG9zaXRvcmllcy8nICsgcmVwb3NpdG9yeSArICcvaXRlbXMvJyArIHdvcmtzcGFjZSArICcvcGFyYW1ldGVycy8nICsgcGFyYW1ldGVyKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrKTsKICAgIH0sCgogICAgLyoqDQogICAgICogR2VuZXJhdGVzIGEgc3RhbmRhcmQgd29ya3NwYWNlIHBhcmFtZXRlcnMgZm9ybQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpZCAtIFRoZSBjb250YWluZXIgaWQgaW4gd2hpY2ggdG8gcGxhY2UgdGhlIGZvcm0gZWxlbWVudHMNCiAgICAgKiBAcGFyYW0ge09iamVjdH0ganNvbiAtIFRoZSBqc29uIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIGZvcm0gcGFyYW1ldGVycyAoY2FuIGNvbWUgZGlyZWN0bHkgZnJvbSBnZXRXb3Jrc3BhY2VQYXJhbWV0ZXJzKQ0KICAgICAqIEBwYXJhbSB7QXJyYXl9IGl0ZW1zIC0gKE9wdGlvbmFsKSBUaGUgYXJyYXkgb2YgcGFyYW1ldGVyIG5hbWVzIHlvdSB3aXNoIHRvIGV4cG9zZSwgYnkgZGVmYXVsdCBhbGwgcGFyYW1ldGVycyBhcmUgZXhwb3NlZA0KICAgICAqLwogICAgZ2VuZXJhdGVGb3JtSXRlbXM6IGZ1bmN0aW9uIGdlbmVyYXRlRm9ybUl0ZW1zKGlkLCBqc29uLCBpdGVtcykgewogICAgICB2YXIgZm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsgLy9pZiBhIHNpbmdsZSBwYXJhbWV0ZXIgaXMgc2VudCBhcyBqc29uLCBhZGQgaXQgaW50byBhbiBhcnJheSBmaXJzdAoKICAgICAgaWYgKHR5cGVvZiBqc29uLmxlbmd0aCA9PSAndW5kZWZpbmVkJykgewogICAgICAgIGpzb24gPSBbanNvbl07CiAgICAgIH0gLy8gTG9vcCB0aHJvdWdoIHRoZSBKU09OIG9iamVjdCBhbmQgYnVpbGQgdGhlIGZvcm0KCgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGpzb24ubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgcGFyYW0gPSBqc29uW2ldOwoKICAgICAgICBpZiAoIWl0ZW1zIHx8IGl0ZW1zLmluZGV4T2YocGFyYW0ubmFtZSkgIT09IC0xKSB7CiAgICAgICAgICB2YXIgc3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTsKICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlKCJjbGFzcyIsIHBhcmFtLm5hbWUgKyAiIGZtZXMtZm9ybS1jb21wb25lbnQiKTsKICAgICAgICAgIHZhciBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxhYmVsIik7CiAgICAgICAgICBsYWJlbC5pbm5lckhUTUwgPSBwYXJhbS5kZXNjcmlwdGlvbjsKICAgICAgICAgIHNwYW4uYXBwZW5kQ2hpbGQobGFiZWwpOwogICAgICAgICAgdmFyIGNob2ljZTsKCiAgICAgICAgICBpZiAocGFyYW0udHlwZSA9PT0gIkZJTEVfT1JfVVJMIiB8fCBwYXJhbS50eXBlID09PSAiRklMRU5BTUVfTVVTVEVYSVNUIiB8fCBwYXJhbS50eXBlID09PSAiRklMRU5BTUUiKSB7CiAgICAgICAgICAgIGNob2ljZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CiAgICAgICAgICAgIGNob2ljZS50eXBlID0gImZpbGUiOwogICAgICAgICAgICBjaG9pY2UubmFtZSA9IHBhcmFtLm5hbWU7CiAgICAgICAgICB9IGVsc2UgaWYgKHBhcmFtLnR5cGUgPT09ICJMSVNUQk9YIiB8fCBwYXJhbS50eXBlID09PSAiTE9PS1VQX0xJU1RCT1giKSB7CiAgICAgICAgICAgIGNob2ljZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICAgICAgICB2YXIgb3B0aW9ucyA9IHBhcmFtLmxpc3RPcHRpb25zOwoKICAgICAgICAgICAgZm9yICh2YXIgYSA9IDA7IGEgPCBvcHRpb25zLmxlbmd0aDsgYSsrKSB7CiAgICAgICAgICAgICAgdmFyIG9wdGlvbiA9IG9wdGlvbnNbYV07CiAgICAgICAgICAgICAgdmFyIGNoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTsKICAgICAgICAgICAgICBjaGVja2JveC50eXBlID0gImNoZWNrYm94IjsKICAgICAgICAgICAgICBjaGVja2JveC52YWx1ZSA9IG9wdGlvbi52YWx1ZTsKICAgICAgICAgICAgICBjaGVja2JveC5uYW1lID0gcGFyYW0ubmFtZTsKICAgICAgICAgICAgICBjaG9pY2UuYXBwZW5kQ2hpbGQoY2hlY2tib3gpOwogICAgICAgICAgICAgIHZhciBjYXB0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGFiZWwiKTsKICAgICAgICAgICAgICBjYXB0aW9uLmlubmVySFRNTCA9IG9wdGlvbi5jYXB0aW9uOwogICAgICAgICAgICAgIGNob2ljZS5hcHBlbmRDaGlsZChjYXB0aW9uKTsKCiAgICAgICAgICAgICAgaWYgKGNoZWNrYm94LnZhbHVlID09IHBhcmFtLmRlZmF1bHRWYWx1ZSkgewogICAgICAgICAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IHRydWU7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHBhcmFtLnR5cGUgPT09ICJMT09LVVBfQ0hPSUNFIiB8fCBwYXJhbS50eXBlID09PSAiU1RSSU5HX09SX0NIT0lDRSIgfHwgcGFyYW0udHlwZSA9PT0gIkNIT0lDRSIpIHsKICAgICAgICAgICAgY2hvaWNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2VsZWN0Iik7CiAgICAgICAgICAgIGNob2ljZS5uYW1lID0gcGFyYW0ubmFtZTsKICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBwYXJhbS5saXN0T3B0aW9uczsKCiAgICAgICAgICAgIGZvciAodmFyIGEgPSAwOyBhIDwgb3B0aW9ucy5sZW5ndGg7IGErKykgewogICAgICAgICAgICAgIHZhciBvcHRpb24gPSBvcHRpb25zW2FdOwogICAgICAgICAgICAgIHZhciBvcHRpb25JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIik7CiAgICAgICAgICAgICAgb3B0aW9uSXRlbS5pbm5lckhUTUwgPSBvcHRpb24uY2FwdGlvbjsKICAgICAgICAgICAgICBvcHRpb25JdGVtLnZhbHVlID0gb3B0aW9uLnZhbHVlOwogICAgICAgICAgICAgIGNob2ljZS5hcHBlbmRDaGlsZChvcHRpb25JdGVtKTsKCiAgICAgICAgICAgICAgaWYgKG9wdGlvbkl0ZW0udmFsdWUgPT0gcGFyYW0uZGVmYXVsdFZhbHVlKSB7CiAgICAgICAgICAgICAgICBvcHRpb25JdGVtLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSBpZiAocGFyYW0udHlwZSA9PT0gIlRFWFRfRURJVCIpIHsKICAgICAgICAgICAgY2hvaWNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGV4dGFyZWEiKTsKICAgICAgICAgICAgY2hvaWNlLm5hbWUgPSBwYXJhbS5uYW1lOwogICAgICAgICAgICBjaG9pY2UudmFsdWUgPSBwYXJhbS5kZWZhdWx0VmFsdWU7CiAgICAgICAgICB9IGVsc2UgaWYgKHBhcmFtLnR5cGUgPT0gIklOVEVHRVIiKSB7CiAgICAgICAgICAgIGNob2ljZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7CiAgICAgICAgICAgIGNob2ljZS50eXBlID0gIm51bWJlciI7CiAgICAgICAgICAgIGNob2ljZS5uYW1lID0gcGFyYW0ubmFtZTsKICAgICAgICAgICAgY2hvaWNlLnZhbHVlID0gcGFyYW0uZGVmYXVsdFZhbHVlOwogICAgICAgICAgfSBlbHNlIGlmIChwYXJhbS50eXBlID09ICJQQVNTV09SRCIpIHsKICAgICAgICAgICAgY2hvaWNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKTsKICAgICAgICAgICAgY2hvaWNlLnR5cGUgPSAicGFzc3dvcmQiOwogICAgICAgICAgICBjaG9pY2UubmFtZSA9IHBhcmFtLm5hbWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjaG9pY2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpOwogICAgICAgICAgICBjaG9pY2UudmFsdWUgPSBwYXJhbS5kZWZhdWx0VmFsdWU7CiAgICAgICAgICAgIGNob2ljZS5uYW1lID0gcGFyYW0ubmFtZTsKICAgICAgICAgIH0KCiAgICAgICAgICBzcGFuLmFwcGVuZENoaWxkKGNob2ljZSk7CiAgICAgICAgICBmb3JtLmFwcGVuZENoaWxkKHNwYW4pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvKioNCiAgICAgKiBSZXRyaWV2ZXMgYWxsIHNjaGVkdWxlZCBpdGVtcw0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgZ2V0U2NoZWR1bGVzOiBmdW5jdGlvbiBnZXRTY2hlZHVsZXMoY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L3NjaGVkdWxlcycpOwogICAgICBhamF4KHVybCwgY2FsbGJhY2spOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBSZXR1cm5zIGEgc2NoZWR1bGVkIGl0ZW0NCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY2F0ZWdvcnkgLSBTY2hlZHVsZSBjYXRlZ29yeSB0aXRsZQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gU2NoZWR1bGUgbmFtZQ0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgZ2V0U2NoZWR1bGVJdGVtOiBmdW5jdGlvbiBnZXRTY2hlZHVsZUl0ZW0oY2F0ZWdvcnksIGl0ZW0sIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9zY2hlZHVsZXMvJyArIGNhdGVnb3J5ICsgJy8nICsgaXRlbSk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjayk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFJlcGxhY2VzIGEgc2NoZWR1bGVkIGl0ZW0NCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY2F0ZWdvcnkgLSBTY2hlZHVsZSBjYXRlZ29yeSB0aXRsZQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpdGVtIC0gU2NoZWR1bGUgbmFtZQ0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzY2hlZHVsZSAtIE9iamVjdCBob2xkaW5nIHRoZSBzY2hlZHVsZSBpbmZvcm1hdGlvbg0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgcmVwbGFjZVNjaGVkdWxlSXRlbTogZnVuY3Rpb24gcmVwbGFjZVNjaGVkdWxlSXRlbShjYXRlZ29yeSwgaXRlbSwgc2NoZWR1bGUsIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9zY2hlZHVsZXMvJyArIGNhdGVnb3J5ICsgJy8nICsgaXRlbSk7CiAgICAgIHZhciBwYXJhbXMgPSBKU09OLnN0cmluZ2lmeShzY2hlZHVsZSk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ1BVVCcsIHBhcmFtcywgJ2FwcGxpY2F0aW9uL2pzb24nKTsKICAgIH0sCgogICAgLyoqDQogICAgICogUmVtb3ZlIGEgc2NoZWR1bGVkIGl0ZW0NCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gY2F0ZWdvcnkgLSBTY2hlZHVsZSBjYXRlZ29yeSB0aXRsZQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBpdGVtIC0gU2NoZWR1bGUgbmFtZQ0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgcmVtb3ZlU2NoZWR1bGVJdGVtOiBmdW5jdGlvbiByZW1vdmVTY2hlZHVsZUl0ZW0oY2F0ZWdvcnksIGl0ZW0sIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9zY2hlZHVsZXMvJyArIGNhdGVnb3J5ICsgJy8nICsgaXRlbSk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ0RFTEVURScpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBDcmVhdGUgYSBzY2hlZHVsZWQgaXRlbQ0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzY2hlZHVsZSAtIEpzb24gb2JqZWN0IGhvbGRpbmcgdGhlIHNjaGVkdWxlIGluZm9ybWF0aW9uDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBjcmVhdGVTY2hlZHVsZUl0ZW06IGZ1bmN0aW9uIGNyZWF0ZVNjaGVkdWxlSXRlbShzY2hlZHVsZSwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L3NjaGVkdWxlcycpOwogICAgICB2YXIgcGFyYW1zID0gSlNPTi5zdHJpbmdpZnkoc2NoZWR1bGUpOwogICAgICBhamF4KHVybCwgY2FsbGJhY2ssICdQT1NUJywgcGFyYW1zLCAnYXBwbGljYXRpb24vanNvbicpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBHZXQgYWxsIHB1YmxpY2F0aW9ucw0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgZ2V0QWxsUHVibGljYXRpb25zOiBmdW5jdGlvbiBnZXRBbGxQdWJsaWNhdGlvbnMoY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L25vdGlmaWNhdGlvbnMvcHVibGljYXRpb25zJyk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjayk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEdldCBhIHB1YmxpY2F0aW9uDQogICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgLSBQdWJsaWNhdGlvbiBuYW1lDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBnZXRQdWJsaWNhdGlvbjogZnVuY3Rpb24gZ2V0UHVibGljYXRpb24obmFtZSwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICBuYW1lID0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L25vdGlmaWNhdGlvbnMvcHVibGljYXRpb25zLycgKyBuYW1lKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrKTsKICAgIH0sCgogICAgLyoqDQogICAgICogQ3JlYXRlIGEgcHVibGljYXRpb24NCiAgICAgKiBAcGFyYW0ge09iamVjdH0gcHVibGljYXRpb24gLSBPYmplY3QgaG9sZGluZyB0aGUgcHVibGljYXRpb24gaW5mb3JtYXRpb24NCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIGNyZWF0ZVB1YmxpY2F0aW9uOiBmdW5jdGlvbiBjcmVhdGVQdWJsaWNhdGlvbihwdWJsaWNhdGlvbiwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L25vdGlmaWNhdGlvbnMvcHVibGljYXRpb25zJyk7CiAgICAgIHZhciBwYXJhbXMgPSBKU09OLnN0cmluZ2lmeShwdWJsaWNhdGlvbik7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ1BPU1QnLCBwYXJhbXMsICdhcHBsaWNhdGlvbi9qc29uJyk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFVwZGF0ZSBhIHB1YmxpY2F0aW9uDQogICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgLSBQdWJsaWNhdGlvbiBuYW1lDQogICAgICogQHBhcmFtIHtPYmplY3R9IHB1YmxpY2F0aW9uIC0gT2JqZWN0IGhvbGRpbmcgdGhlIHB1YmxpY2F0aW9uIGluZm9ybWF0aW9uDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICB1cGRhdGVQdWJsaWNhdGlvbjogZnVuY3Rpb24gdXBkYXRlUHVibGljYXRpb24obmFtZSwgcHVibGljYXRpb24sIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgbmFtZSA9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKTsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9ub3RpZmljYXRpb25zL3B1YmxpY2F0aW9ucy8nICsgbmFtZSk7CiAgICAgIHZhciBwYXJhbXMgPSBKU09OLnN0cmluZ2lmeShwdWJsaWNhdGlvbik7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ1BVVCcsIHBhcmFtcywgJ2FwcGxpY2F0aW9uL2pzb24nKTsKICAgIH0sCgogICAgLyoqDQogICAgICogRGVsZXRlIGEgcHVibGljYXRpb24NCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSAtIFB1YmxpY2F0aW9uIG5hbWUNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIGRlbGV0ZVB1YmxpY2F0aW9uOiBmdW5jdGlvbiBkZWxldGVQdWJsaWNhdGlvbihuYW1lLCBjYWxsYmFjaykgewogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIG5hbWUgPSBlbmNvZGVVUklDb21wb25lbnQobmFtZSk7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vbm90aWZpY2F0aW9ucy9wdWJsaWNhdGlvbnMvJyArIG5hbWUpOwogICAgICBhamF4KHVybCwgY2FsbGJhY2ssICdERUxFVEUnKTsKICAgIH0sCgogICAgLyoqDQogICAgICogR2V0IFB1Ymxpc2hlciBQcm90b2NvbHMNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIGdldFB1Ymxpc2hlclByb3RvY29sczogZnVuY3Rpb24gZ2V0UHVibGlzaGVyUHJvdG9jb2xzKGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9ub3RpZmljYXRpb25zL3B1Ymxpc2hlcnMvJyk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjayk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFF1ZXJ5IFB1Ymxpc2hlciBQcm90b2NvbA0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gUHJvdG9jb2wgbmFtZQ0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgcXVlcnlQdWJsaXNoZXJQcm90b2NvbDogZnVuY3Rpb24gcXVlcnlQdWJsaXNoZXJQcm90b2NvbChuYW1lLCBjYWxsYmFjaykgewogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vbm90aWZpY2F0aW9ucy9wdWJsaXNoZXJzLycgKyBuYW1lKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrKTsKICAgIH0sCgogICAgLyoqDQogICAgICogR2V0IGFsbCBzdWJzY3JpcHRpb25zDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBnZXRBbGxTdWJzY3JpcHRpb25zOiBmdW5jdGlvbiBnZXRBbGxTdWJzY3JpcHRpb25zKGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9ub3RpZmljYXRpb25zL3N1YnNjcmlwdGlvbnMnKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrKTsKICAgIH0sCgogICAgLyoqDQogICAgICogR2V0IGEgc3Vic2NyaXB0aW9uDQogICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgLSBTdWJzY3JpcHRpb24gbmFtZQ0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgZ2V0U3Vic2NyaXB0aW9uOiBmdW5jdGlvbiBnZXRTdWJzY3JpcHRpb24obmFtZSwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICBuYW1lID0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L25vdGlmaWNhdGlvbnMvc3Vic2NyaXB0aW9ucy8nICsgbmFtZSk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjayk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIENyZWF0ZSBhIHN1YnNjcmlwdGlvbg0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzdWJzY3JpcHRpb24gLSBPYmplY3QgaG9sZGluZyB0aGUgc3Vic2NyaXB0aW9uIGluZm9ybWF0aW9uDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBjcmVhdGVTdWJzY3JpcHRpb246IGZ1bmN0aW9uIGNyZWF0ZVN1YnNjcmlwdGlvbihzdWJzY3JpcHRpb24sIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9ub3RpZmljYXRpb25zL3N1YnNjcmlwdGlvbnMnKTsKICAgICAgdmFyIHBhcmFtcyA9IEpTT04uc3RyaW5naWZ5KHN1YnNjcmlwdGlvbik7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ1BPU1QnLCBwYXJhbXMsICdhcHBsaWNhdGlvbi9qc29uJyk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFVwZGF0ZSBhIHN1YnNjcmlwdGlvbg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gU3Vic2NyaXB0aW9uIG5hbWUNCiAgICAgKiBAcGFyYW0ge09iamVjdH0gc3Vic2NyaXB0aW9uIC0gT2JqZWN0IGhvbGRpbmcgdGhlIHN1YnNjcmlwdGlvbiBpbmZvcm1hdGlvbg0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgdXBkYXRlU3Vic2NyaXB0aW9uOiBmdW5jdGlvbiB1cGRhdGVTdWJzY3JpcHRpb24obmFtZSwgc3Vic2NyaXB0aW9uLCBjYWxsYmFjaykgewogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIG5hbWUgPSBlbmNvZGVVUklDb21wb25lbnQobmFtZSk7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vbm90aWZpY2F0aW9ucy9zdWJzY3JpcHRpb25zLycgKyBuYW1lKTsKICAgICAgY29uc29sZS5sb2codXJsKTsKICAgICAgdmFyIHBhcmFtcyA9IEpTT04uc3RyaW5naWZ5KHN1YnNjcmlwdGlvbik7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ1BVVCcsIHBhcmFtcywgJ2FwcGxpY2F0aW9uL2pzb24nKTsKICAgIH0sCgogICAgLyoqDQogICAgICogRGVsZXRlIGEgc3Vic2NyaXB0aW9uDQogICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgLSBTdWJzY3JpcHRpb24gbmFtZQ0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgZGVsZXRlU3Vic2NyaXB0aW9uOiBmdW5jdGlvbiBkZWxldGVTdWJzY3JpcHRpb24obmFtZSwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICBuYW1lID0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L25vdGlmaWNhdGlvbnMvc3Vic2NyaXB0aW9ucy8nICsgbmFtZSk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ0RFTEVURScpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBHZXQgU3Vic2NyaWJlciBQcm90b2NvbHMNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIGdldFN1YnNjcmliZXJQcm90b2NvbHM6IGZ1bmN0aW9uIGdldFN1YnNjcmliZXJQcm90b2NvbHMoY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L25vdGlmaWNhdGlvbnMvc3Vic2NyaWJlcnMvJyk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjayk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFF1ZXJ5IFN1YnNjcmliZXIgUHJvdG9jb2wNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSAtIFByb3RvY29sIG5hbWUNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIHF1ZXJ5U3Vic2NyaWJlclByb3RvY29sOiBmdW5jdGlvbiBxdWVyeVN1YnNjcmliZXJQcm90b2NvbChuYW1lLCBjYWxsYmFjaykgewogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vbm90aWZpY2F0aW9ucy9zdWJzY3JpYmVycy8nICsgbmFtZSk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjayk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEdldCBOb3RpZmljYXRpb24gVG9waWNzDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBnZXROb3RpZmljYXRpb25Ub3BpY3M6IGZ1bmN0aW9uIGdldE5vdGlmaWNhdGlvblRvcGljcyhjYWxsYmFjaykgewogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vbm90aWZpY2F0aW9ucy90b3BpY3MnKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrKTsKICAgIH0sCgogICAgLyoqDQogICAgICogR2V0IE5vdGlmaWNhdGlvbiBUb3BpYw0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gVG9waWMgbmFtZQ0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgZ2V0Tm90aWZpY2F0aW9uVG9waWM6IGZ1bmN0aW9uIGdldE5vdGlmaWNhdGlvblRvcGljKG5hbWUsIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgbmFtZSA9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKTsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9ub3RpZmljYXRpb25zL3RvcGljcy8nICsgbmFtZSk7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjayk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIENyZWF0ZSBUb3BpYw0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gVG9waWMgbmFtZQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkZXNjcmlwdGlvbiAtIFRvcGljIGRlc2NyaXB0aW9uDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBjcmVhdGVUb3BpYzogZnVuY3Rpb24gY3JlYXRlVG9waWMobmFtZSwgZGVzY3JpcHRpb24sIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgbmFtZSA9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKS5yZXBsYWNlKC8lMjAvZywgJysnKTsKICAgICAgZGVzY3JpcHRpb24gPSBlbmNvZGVVUklDb21wb25lbnQoZGVzY3JpcHRpb24pLnJlcGxhY2UoLyUyMC9nLCAnKycpOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L25vdGlmaWNhdGlvbnMvdG9waWNzJyk7CiAgICAgIHZhciBwYXJhbXMgPSAibmFtZT0iICsgbmFtZSArICImZGVzY3JpcHRpb249IiArIGRlc2NyaXB0aW9uOwogICAgICBhamF4KHVybCwgY2FsbGJhY2ssICdQT1NUJywgcGFyYW1zLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFVwZGF0ZSBUb3BpYyBEZXNjcmlwdGlvbg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gVG9waWMgbmFtZQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBkZXNjcmlwdGlvbiAtIFRvcGljIGRlc2NyaXB0aW9uDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICB1cGRhdGVUb3BpYzogZnVuY3Rpb24gdXBkYXRlVG9waWMobmFtZSwgZGVzY3JpcHRpb24sIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgbmFtZSA9IGVuY29kZVVSSUNvbXBvbmVudChuYW1lKTsKICAgICAgZGVzY3JpcHRpb24gPSBlbmNvZGVVUklDb21wb25lbnQoZGVzY3JpcHRpb24pLnJlcGxhY2UoLyUyMC9nLCAnKycpOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L25vdGlmaWNhdGlvbnMvdG9waWNzLycgKyBuYW1lKTsKICAgICAgdmFyIHBhcmFtcyA9ICJkZXNjcmlwdGlvbj0iICsgZGVzY3JpcHRpb247CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgJ1BVVCcsIHBhcmFtcywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBEZWxldGUgVG9waWMNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBUb3BpYyBuYW1lDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBkZWxldGVUb3BpYzogZnVuY3Rpb24gZGVsZXRlVG9waWMobmFtZSwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICBuYW1lID0gZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L25vdGlmaWNhdGlvbnMvdG9waWNzLycgKyBuYW1lKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrLCAnREVMRVRFJyk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFB1Ymxpc2ggSlNPTiB0byBhIHRvcGljDQogICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgLSBUb3BpYyBuYW1lDQogICAgICogQHBhcmFtIHtTdHJpbmd9IG1lc3NhZ2UgLSBUaGUgZGF0YSBhcyBhIGpzb24gc3RyaW5nDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBwdWJsaXNoVG9Ub3BpY1N0cnVjdHVyZWQ6IGZ1bmN0aW9uIHB1Ymxpc2hUb1RvcGljU3RydWN0dXJlZChuYW1lLCBtZXNzYWdlLCBjYWxsYmFjaykgewogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIG5hbWUgPSBlbmNvZGVVUklDb21wb25lbnQobmFtZSk7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vbm90aWZpY2F0aW9ucy90b3BpY3MvJyArIG5hbWUgKyAnL21lc3NhZ2UnKTsKICAgICAgdmFyIHR5cGUgPSAnYXBwbGljYXRpb24vanNvbic7CgogICAgICB0cnkgewogICAgICAgIG1lc3NhZ2UgPSBKU09OLnBhcnNlKG1lc3NhZ2UpOwogICAgICAgIG1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeShtZXNzYWdlKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHZhciByZXNwb25zZSA9IHsKICAgICAgICAgIHJlc3BvbnNlOiAnVW5hYmxlIHRvIHBhcnNlIEpTT04nCiAgICAgICAgfTsKICAgICAgICBjYWxsYmFjayhyZXNwb25zZSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBhamF4KHVybCwgY2FsbGJhY2ssICdQT1NUJywgbWVzc2FnZSwgdHlwZSk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFB1Ymxpc2ggYW55dGhpbmcgdG8gYSB0b3BpYw0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIC0gVG9waWMgbmFtZQ0KICAgICAqIEBwYXJhbSB7T2JqZWN0fSBvciB7U3RyaW5nfSBtZXNzYWdlIC0gVGhlIHJhdyB0ZXh0IGRhdGENCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIHB1Ymxpc2hUb1RvcGljOiBmdW5jdGlvbiBwdWJsaXNoVG9Ub3BpYyhuYW1lLCBtZXNzYWdlLCBjYWxsYmFjaykgewogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIG5hbWUgPSBlbmNvZGVVUklDb21wb25lbnQobmFtZSk7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vbm90aWZpY2F0aW9ucy90b3BpY3MvJyArIG5hbWUgKyAnL21lc3NhZ2Uvc3Vic2NyaWJlcmNvbnRlbnQnKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrLCAnUE9TVCcsIG1lc3NhZ2UsICcqLyonKTsKICAgIH0sCgogICAgLyoqDQogICAgICogTG9va3VwIHVzZXIgdG9rZW4NCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdXNlciAtIFRoZSB1c2VybmFtZSBmb3IgdGhlIHJlcXVpcmVkIGxldmVsIG9mIGFjY2Vzcw0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwYXNzd29yZCAtIFRoZSBwYXNzd29yZCB0aGF0IGJlbG9uZ3MgdG8gdGhhdCB1c2VyDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBsb29rdXBUb2tlbjogZnVuY3Rpb24gbG9va3VwVG9rZW4odXNlciwgcGFzc3dvcmQsIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXRva2VuL3NlcnZpY2Uvdmlldy5qc29uJyk7CiAgICAgIHZhciBwYXJhbXMgPSAndXNlcj0nICsgdXNlciArICcmcGFzc3dvcmQ9JyArIHBhc3N3b3JkOwogICAgICBhamF4KHVybCwgY2FsbGJhY2ssICdQT1NUJywgcGFyYW1zLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIEdlbmVyYXRlIGd1ZXN0IHRva2VuDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHVzZXIgLSBUaGUgdXNlcm5hbWUgZm9yIHRoZSByZXF1aXJlZCBsZXZlbCBvZiBhY2Nlc3MNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFzc3dvcmQgLSBUaGUgcGFzc3dvcmQgdGhhdCBiZWxvbmdzIHRvIHRoYXQgdXNlcg0KICAgICAqIEBwYXJhbSB7SW50ZWdlcn0gY291bnQgLSBUaGUgbnVtYmVyIG9mIHNlY29uZHMsIG1pbnV0ZXMsIGhvdXJzLCBvciBkYXlzIGZvciB0aGUgdG9rZW4gdG8gbGFzdA0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSB1bml0IC0gVW5pdCBvZiB0aW1lIGZvciB0aGUgdG9rZW4gdG8gbGFzdCAoY2FuIGJlIHNlY29uZCwgbWludXRlLCBob3VyLCBvciBkYXkpDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBnZW5lcmF0ZVRva2VuOiBmdW5jdGlvbiBnZW5lcmF0ZVRva2VuKHVzZXIsIHBhc3N3b3JkLCBjb3VudCwgdW5pdCwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1ldG9rZW4vc2VydmljZS9nZW5lcmF0ZScpOwogICAgICB2YXIgcGFyYW1zID0gJ3VzZXI9JyArIHVzZXIgKyAnJnBhc3N3b3JkPScgKyBwYXNzd29yZCArICcmZXhwaXJhdGlvbj0nICsgY291bnQgKyAnJnRpbWV1bml0PScgKyB1bml0OwogICAgICBhamF4KHVybCwgY2FsbGJhY2ssICdQT1NUJywgcGFyYW1zLCAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJyk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFN1Ym1pdCBhIEpvYiB0byBSdW4gYXN5bmNocm9ub3VzbHkNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcmVwb3NpdG9yeSAtIFRoZSByZXBvc2l0b3J5IG9uIHRoZSBGTUUgU2VydmVyDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHdvcmtzcGFjZSAtIFRoZSBuYW1lIG9mIHRoZSB3b3Jrc3BhY2Ugb24gRk1FIFNlcnZlciwgaS5lLiB3b3Jrc3BhY2UuZm13DQogICAgICogQHBhcmFtIHtTdHJpbmd9IHBhcmFtcyAtIEFueSB3b3Jrc3BhY2Utc3BlY2lmaWMgcGFyYW1ldGVyIHZhbHVlcyBhcyBqc29uDQogICAgICogIGkuZS4gY2FuIGJlIGRlZmluZWQgbGlrZToNCiAgICAgKiAgdmFyIHBhcmFtZXRlcnMgPSB7J3B1Ymxpc2hlZFBhcmFtZXRlcnMnIDogWw0KICAgIHsnbmFtZSc6ICdNQVhZJywgJ3ZhbHVlJzonNDInfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7J25hbWUnOidUSEVNRVMnLCd2YWx1ZSc6WydhaXJwb3J0cycsICdjZW5hcnQnXX1dDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBzdWJtaXRKb2I6IGZ1bmN0aW9uIHN1Ym1pdEpvYihyZXBvc2l0b3J5LCB3b3Jrc3BhY2UsIHBhcmFtcywgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L3RyYW5zZm9ybWF0aW9ucy9zdWJtaXQvJyArIHJlcG9zaXRvcnkgKyAnLycgKyB3b3Jrc3BhY2UpOwogICAgICBwYXJhbXMgPSBKU09OLnN0cmluZ2lmeShwYXJhbXMpOwogICAgICBhamF4KHVybCwgY2FsbGJhY2ssICdQT1NUJywgcGFyYW1zLCAnYXBwbGljYXRpb24vanNvbicpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBTdWJtaXQgYSBKb2IgdG8gUnVuIFN5bmNocm9ub3VzbHkNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcmVwb3NpdG9yeSAtIFRoZSByZXBvc2l0b3J5IG9uIHRoZSBGTUUgU2VydmVyDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHdvcmtzcGFjZSAtIFRoZSBuYW1lIG9mIHRoZSB3b3Jrc3BhY2Ugb24gRk1FIFNlcnZlciwgaS5lLiB3b3Jrc3BhY2UuZm13DQogICAgICogQHBhcmFtIHtTdHJpbmd9IHBhcmFtcyAtIEFueSB3b3Jrc3BhY2Utc3BlY2lmaWMgcGFyYW1ldGVyIHZhbHVlcyBhcyBqc29uDQogICAgICogaS5lLiBjYW4gYmUgZGVmaW5lZCBsaWtlOg0KICAgICAqICB2YXIgcGFyYW1ldGVycyA9IHsncHVibGlzaGVkUGFyYW1ldGVycycgOiBbDQogICAgeyduYW1lJzogJ01BWFknLCAndmFsdWUnOic0Mid9LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsnbmFtZSc6J1RIRU1FUycsJ3ZhbHVlJzpbJ2FpcnBvcnRzJywgJ2NlbmFydCddfV0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIHN1Ym1pdFN5bmNKb2I6IGZ1bmN0aW9uIHN1Ym1pdFN5bmNKb2IocmVwb3NpdG9yeSwgd29ya3NwYWNlLCBwYXJhbXMsIGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS90cmFuc2Zvcm1hdGlvbnMvdHJhbnNhY3QvJyArIHJlcG9zaXRvcnkgKyAnLycgKyB3b3Jrc3BhY2UpOwogICAgICBwYXJhbXMgPSBKU09OLnN0cmluZ2lmeShwYXJhbXMpOwogICAgICBhamF4KHVybCwgY2FsbGJhY2ssICdQT1NUJywgcGFyYW1zLCAnYXBwbGljYXRpb24vanNvbicpOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBHZXQgYSBMaXN0IG9mIEFsbCBTaGFyZWQgUmVzb3VyY2UgQ29ubmVjdGlvbnMNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKi8KICAgIGdldFJlc291cmNlczogZnVuY3Rpb24gZ2V0UmVzb3VyY2VzKGNhbGxiYWNrKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9yZXNvdXJjZXMvY29ubmVjdGlvbnMnKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrKTsKICAgIH0sCgogICAgLyoqDQogICAgICogR2V0IFJlc291cmNlIENvbm5lY3Rpb24gZGV0YWlscw0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXNvdXJjZSAtIFRoZSByZXNvdXJjZSBuYW1lDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBnZXRSZXNvdXJjZURldGFpbHM6IGZ1bmN0aW9uIGdldFJlc291cmNlRGV0YWlscyhyZXNvdXJjZSwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICB2YXIgdXJsID0gYnVpbGRVUkwoJ3t7c3ZyfX0vZm1lcmVzdC97e3Zlcn19L3Jlc291cmNlcy9jb25uZWN0aW9ucy8nICsgcmVzb3VyY2UpOwogICAgICBhamF4KHVybCwgY2FsbGJhY2spOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBHZXQgdGhlIG1ldGFkYXRhIGZvciBhIGRpcmVjdG9yeSBvciByZWd1bGFyIGZpbGUgaW5zaWRlIGEgUmVzb3VyY2UgQ29ubmVjdGlvbg0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXNvdXJjZSAtIFRoZSByZXNvdXJjZSBuYW1lDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHBhdGggLSBUaGUgZm9sZGVyIG9yIGZpbGUgcGF0aCB3aXRoaW4gdGhlIHJlc291cmNlIG9uIEZNRSBTZXJ2ZXINCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZGVwdGggLSBUaGUgbnVtYmVyIG9mIGRpcmVjdG9yeSBsZXZlbHMgZGVlcCBmcm9tIHdoaWNoIHRvIHJldHJpZXZlIG1ldGFkYXRhDQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgLSBDYWxsYmFjayBmdW5jdGlvbiBhY2NlcHRpbmcgdGhlIGpzb24gcmV0dXJuIHZhbHVlDQogICAgICovCiAgICBnZXRSZXNvdXJjZUNvbnRlbnRzOiBmdW5jdGlvbiBnZXRSZXNvdXJjZUNvbnRlbnRzKHJlc291cmNlLCBwYXRoLCBkZXB0aCwgY2FsbGJhY2spIHsKICAgICAgY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBudWxsOwogICAgICBwYXRoID0gcGF0aCB8fCAnLyc7CiAgICAgIHBhdGggPSBlbmNvZGVVUklDb21wb25lbnQocGF0aCkucmVwbGFjZSgvJTJGL2csICcvJyk7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vcmVzb3VyY2VzL2Nvbm5lY3Rpb25zLycgKyByZXNvdXJjZSArICcvZmlsZXN5cycgKyBwYXRoICsgJz9kZXB0aD0nICsgZGVwdGgpOwogICAgICBhamF4KHVybCwgY2FsbGJhY2spOwogICAgfSwKCiAgICAvKioNCiAgICAgKiBEZWxldGUgUmVzb3VyY2UgRmlsZQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXNvdXJjZSAtIFRoZSByZXNvdXJjZSBuYW1lDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHBhdGggLSBUaGUgZmlsZSBwYXRoIHdpdGhpbiB0aGUgcmVzb3VyY2Ugb24gdGhlIHNlcnZlcg0KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrIC0gQ2FsbGJhY2sgZnVuY3Rpb24gYWNjZXB0aW5nIHRoZSBqc29uIHJldHVybiB2YWx1ZQ0KICAgICAqLwogICAgZGVsZXRlUmVzb3VyY2U6IGZ1bmN0aW9uIGRlbGV0ZVJlc291cmNlKHJlc291cmNlLCBwYXRoLCBjYWxsYmFjaykgewogICAgICBjYWxsYmFjayA9IGNhbGxiYWNrIHx8IG51bGw7CiAgICAgIHBhdGggPSBlbmNvZGVVUklDb21wb25lbnQocGF0aCkucmVwbGFjZSgvJTJGL2csICcvJyk7CiAgICAgIHZhciB1cmwgPSBidWlsZFVSTCgne3tzdnJ9fS9mbWVyZXN0L3t7dmVyfX0vcmVzb3VyY2VzL2Nvbm5lY3Rpb25zLycgKyByZXNvdXJjZSArICcvZmlsZXN5cycgKyBwYXRoKTsKICAgICAgYWpheCh1cmwsIGNhbGxiYWNrLCAnREVMRVRFJyk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIERvd25sb2FkIFJlc291cmNlIEZpbGUNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcmVzb3VyY2UgLSBUaGUgcmVzb3VyY2UgbmFtZQ0KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBwYXRoIC0gVGhlIHJlc291cmNlIGZpbGUgcGF0aCBvbiB0aGUgc2VydmVyDQogICAgICovCiAgICBkb3dubG9hZFJlc291cmNlRmlsZTogZnVuY3Rpb24gZG93bmxvYWRSZXNvdXJjZUZpbGUocmVzb3VyY2UsIHBhdGgpIHsKICAgICAgcGF0aCA9IGVuY29kZVVSSUNvbXBvbmVudChwYXRoKS5yZXBsYWNlKC8lMkYvZywgJy8nKTsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9yZXNvdXJjZXMvY29ubmVjdGlvbnMvJyArIHJlc291cmNlICsgJy9maWxlc3lzJyArIHBhdGggKyAnP2FjY2VwdD1jb250ZW50cycpOwogICAgICB2YXIgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7CiAgICAgIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGlmcmFtZSk7CiAgICAgIGlmcmFtZS5zcmMgPSB1cmwgKyAnJnRva2VuPScgKyBnZXRDb25maWcoJ3Rva2VuJyk7CiAgICB9LAoKICAgIC8qKg0KICAgICAqIFVwbG9hZCBSZXNvdXJjZSBGaWxlDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHJlc291cmNlIC0gVGhlIHJlc291cmNlIG5hbWUNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGF0aCAtIFRoZSBmaWxlIHBhdGggd2l0aGluIHRoZSByZXNvdXJjZSBvbiB0aGUgc2VydmVyDQogICAgICogQHBhcmFtIHtPYmplY3R9IGZpbGVzIC0gVGhlIGZvcm0gZmlsZSBvYmplY3QNCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IG92ZXJ3cml0ZSAtIE92ZXJ3cml0ZSBmaWxlcywgdHJ1ZSBvciBmYWxzZShkZWZhdWx0KQ0KICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gY3JlYXRlRm9sZGVycyAtIENyZWF0ZSBmb2xkZXJzIGZyb20gcGF0aCwgdHJ1ZSBvciBmYWxzZShkZWZhdWx0KQ0KICAgICAqLwogICAgdXBsb2FkUmVzb3VyY2VGaWxlOiBmdW5jdGlvbiB1cGxvYWRSZXNvdXJjZUZpbGUocmVzb3VyY2UsIHBhdGgsIGZpbGVzLCBjYWxsYmFjaywgb3ZlcndyaXRlLCBjcmVhdGVGb2xkZXJzKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgb3ZlcndyaXRlID0gb3ZlcndyaXRlIHx8IGZhbHNlOwogICAgICBjcmVhdGVGb2xkZXJzID0gY3JlYXRlRm9sZGVycyB8fCBmYWxzZTsKICAgICAgcGF0aCA9IGVuY29kZVVSSUNvbXBvbmVudChwYXRoKS5yZXBsYWNlKC8lMkYvZywgJy8nKTsKICAgICAgdmFyIHVybCA9IGJ1aWxkVVJMKCd7e3N2cn19L2ZtZXJlc3Qve3t2ZXJ9fS9yZXNvdXJjZXMvY29ubmVjdGlvbnMvJyArIHJlc291cmNlICsgJy9maWxlc3lzJyArIHBhdGgpOwogICAgICB1cmwgPSB1cmwgKyAnP2NyZWF0ZURpcmVjdG9yaWVzPScgKyBjcmVhdGVGb2xkZXJzICsgJyZvdmVyd3JpdGU9JyArIG92ZXJ3cml0ZSArICcmdHlwZT1GSUxFJzsKICAgICAgdmFyIHBhcmFtcyA9IG5ldyBGb3JtRGF0YSgpOyAvLyBMb29wIHRocm91Z2gsIHN1cHBvcnQgZm9yIG11bHRpcGxlIGZpbGVzCgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGZpbGVzLmZpbGVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgcGFyYW1zLmFwcGVuZCgnZmlsZXNbXScsIGZpbGVzLmZpbGVzW2ldKTsKICAgICAgfQoKICAgICAgdXJsID0gdXJsOwogICAgICBhamF4KHVybCwgY2FsbGJhY2ssICdQT1NUJywgcGFyYW1zKTsKICAgIH0sCgogICAgLyoqDQogICAgICogU3VibWl0IGEgY3VzdG9tIFJFU1QgcmVxdWVzdCBkaXJlY3RseSB0byB0aGUgQVBJDQogICAgICogQHBhcmFtIHtTdHJpbmd9IHVybCAtIEZ1bGwgdXJsIG9mIHRoZSBSRVNUIGNhbGwgaW5jbHVkaW5nIHRoZSBzZXJ2ZXINCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gdHlwZSAtIFRoZSByZXF1ZXN0IHR5cGUsIGkuZS4gR0VULCBQT1NULCBQVVNILCAuLi4NCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayAtIENhbGxiYWNrIGZ1bmN0aW9uIGFjY2VwdGluZyB0aGUganNvbiByZXR1cm4gdmFsdWUNCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gcGFyYW1zIC0gQW55IHBhcmFtZXRlciB2YWx1ZXMgcmVxdWlyZWQgYnkgdGhlIEFQSSAoT3B0aW9uYWwpDQogICAgICogQHBhcmFtIHtTdHJpbmd9IGN0eXAgLSBUaGUgQ29udGVudCB0eXBlIG9mIHRoZSBkYXRhIGJlaW5nIHNlbnQsIGV4OiAnYXBwbGljYXRpb24vanNvbicNCiAgICAgKi8KICAgIGN1c3RvbVJlcXVlc3Q6IGZ1bmN0aW9uIGN1c3RvbVJlcXVlc3QodXJsLCB0eXBlLCBjYWxsYmFjaywgcGFyYW1zLCBjdHlwKSB7CiAgICAgIGNhbGxiYWNrID0gY2FsbGJhY2sgfHwgbnVsbDsKICAgICAgcGFyYW1zID0gcGFyYW1zIHx8IG51bGw7CiAgICAgIHR5cGUgPSB0eXBlLnRvVXBwZXJDYXNlKCk7CiAgICAgIGN0eXAgPSBjdHlwIHx8IG51bGw7CiAgICAgIGFqYXgodXJsLCBjYWxsYmFjaywgdHlwZSwgcGFyYW1zLCBjdHlwKTsKICAgIH0KICB9OwogIC8qKg0KICAgKiBSZXR1cm4gdGhlIGNvbnN0cnVjdGVkIEZNRVNlcnZlciBDb25uZWN0aW9uIE9iamVjdA0KICAgKi8KCiAgcmV0dXJuIGZtZTsKfSgpOw=="},{"version":3,"sources":["C:/Users/DPROSACK/Documents/GitHub/CRI-Update/src/plugins/fmeserver.js"],"names":["FMEServer","Array","prototype","indexOf","obj","start","i","j","length","String","trim","replace","config","version","getConfig","param","getResponseType","type","accept","split","checkConfig","Error","ajax","url","callback","rtyp","params","ctyp","atyp","req","XDomainRequest","open","onload","resp","responseText","JSON","parse","e","send","XMLHttpRequest","setRequestHeader","name","contents","onreadystatechange","done","readyState","status","response","buildURL","fme","init","server","token","format","detail","port","ssl","undefined","xdomain","charAt","substr","substring","location","host","navigator","appName","appVersion","stdPorts","getSession","repository","workspace","min","max","Math","floor","random","getWebSocketConnection","id","ws","WebSocket","onopen","openMsg","ws_op","ws_stream_id","stringify","runDataDownload","runDataStreaming","dataUpload","files","jsid","FormData","parseInt","iframe","document","createElement","style","display","body","appendChild","form","action","method","enctype","input","cloneNode","target","submit","append","getDataUploads","runWorkspaceWithData","service","extra","filename","f","path","getRepositories","getRepositoryItems","getWorkspaceParameters","queryWorkspaceParameter","parameter","generateFormItems","json","items","getElementById","span","setAttribute","label","innerHTML","description","choice","options","listOptions","a","option","checkbox","value","caption","defaultValue","checked","optionItem","selected","getSchedules","getScheduleItem","category","item","replaceScheduleItem","schedule","removeScheduleItem","createScheduleItem","getAllPublications","getPublication","encodeURIComponent","createPublication","publication","updatePublication","deletePublication","getPublisherProtocols","queryPublisherProtocol","getAllSubscriptions","getSubscription","createSubscription","subscription","updateSubscription","console","log","deleteSubscription","getSubscriberProtocols","querySubscriberProtocol","getNotificationTopics","getNotificationTopic","createTopic","updateTopic","deleteTopic","publishToTopicStructured","message","publishToTopic","lookupToken","user","password","generateToken","count","unit","submitJob","submitSyncJob","getResources","getResourceDetails","resource","getResourceContents","depth","deleteResource","downloadResourceFile","src","uploadResourceFile","overwrite","createFolders","customRequest","toUpperCase"],"mappings":"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","sourcesContent":["/*****************************************************************************\r\n * FMEServer.js\r\n * 2018 Safe Software\r\n * support@safe.com\r\n *\r\n * Unofficial JavaScript Library for FME Server >= 2014. This is not intended to\r\n * be a complete API, but rather a collection of boilerplate methods\r\n * for REST API calls typically needed in a web page\r\n * interfacing with FME Server.\r\n *\r\n * The MIT License (MIT)\r\n *\r\n * Copyright (c) 2018 Safe Software\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a copy\r\n * of this software and associated documentation files (the \"Software\"), to deal\r\n * in the Software without restriction, including without limitation the rights\r\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\r\n * copies of the Software, and to permit persons to whom the Software is\r\n * furnished to do so, subject to the following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included in\r\n * all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\r\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\r\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\r\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\r\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\r\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\r\n * THE SOFTWARE.\r\n *\r\n *****************************************************************************/\r\n\r\n/**\r\n * FME Server Library\r\n * @author Safe Software\r\n * @version 3\r\n * @this FMEServer\r\n * @return {FMEServer} fme - FME Server connection object\r\n */\r\n var FMEServer = ( function() {\r\n    /**\r\n     * Add indexOf and trim method for Strings and Array's in older browsers\r\n     */\r\n    if (!Array.prototype.indexOf) {\r\n        Array.prototype.indexOf = function(obj, start) {\r\n            for (var i = (start || 0), j = this.length; i < j; i++) {\r\n                if (this[i] === obj) { return i; }\r\n            }\r\n            return -1;\r\n        };\r\n    }\r\n\r\n    if (typeof String.prototype.trim !== 'function') {\r\n        String.prototype.trim = function() {\r\n            return this.replace(/^\\s+|\\s+$/g, '');\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Configuration object, holds instance configuration\r\n     */\r\n    var config = { version : 'v3' };\r\n\r\n    /**\r\n     * Get Configuration Method\r\n     * @param {String} name - Name of setting\r\n     * @return {String} - individual parameter, or {Object} - config\r\n     */\r\n    function getConfig(param) {\r\n        param = param || null;\r\n        if (param) {\r\n            return config[param];\r\n        }\r\n        return config;\r\n    }\r\n\r\n    /**\r\n     * Get Simple Response Type\r\n     * @return {String} - The extracted simple accept type from the config\r\n     */\r\n    function getResponseType() {\r\n        var type = getConfig('accept'),\r\n            accept = 'json';\r\n        if (type.indexOf('/') !== -1) {\r\n            type = type.split(/\\//g);\r\n            if (type[1].length > 0) {\r\n                accept = type[1];\r\n            }\r\n        }\r\n        return accept;\r\n    }\r\n\r\n    /**\r\n     * Check Config Status\r\n     */\r\n    function checkConfig() {\r\n        if(getConfig('server') && getConfig('token')){\r\n            return true;\r\n        }\r\n        throw new Error('You must initialize FMEServer using the FMEServer.init() method.');\r\n    }\r\n\r\n    /**\r\n     * AJAX Method\r\n     * @param {String} url - The request URL\r\n     * @param {Function} callback - Callback function accepting json response\r\n     * @param {String} rtyp - Type of request ex: PUT, GET(Default)\r\n     * @param {String} params - The json or name=value pair string or parameters\r\n     * @param {String} ctyp - Content type as a string (optional)\r\n     * @param {String} atyp - Accept type as a string (optional)\r\n\r\n     ajax(url, callback, 'POST', params, 'application/x-www-form-urlencoded');\r\n\r\n     */\r\n    function ajax(url, callback, rtyp, params, ctyp, atyp) {\r\n\r\n        if (checkConfig()) {\r\n            if(callback === null || typeof callback != 'function') {\r\n                throw new Error('A callback function must be defined in order to use the FME Server REST API.');\r\n            }\r\n            var req;\r\n            rtyp = rtyp || 'GET';\r\n            params = params || null;\r\n            ctyp = ctyp || null;\r\n            atyp = atyp || getConfig('accept');\r\n\r\n            if (url.indexOf('?') != -1) {\r\n                url += '&detail=' + getConfig('detail');\r\n            } else {\r\n                url += '?detail=' + getConfig('detail');\r\n            }\r\n\r\n            if (getConfig('xdomain')) {\r\n                if (rtyp == 'GET') {\r\n                    req = new XDomainRequest();\r\n                    url += '&token=' + getConfig('token');\r\n                    req.open(rtyp, url);\r\n                    req.onload = function() {\r\n                        var resp;\r\n                        resp = req.responseText;\r\n                        try {\r\n                            resp = JSON.parse(resp);\r\n                        } catch (e) {\r\n                            // Not a JSON response\r\n                        } finally {\r\n                            callback(resp);\r\n                        }\r\n                    };\r\n                    req.send();\r\n                } else {\r\n                    throw new Error('IE8 and IE9 Only support CORS requests through GET methods. Only partial functionality is available.');\r\n                }\r\n            } else {\r\n                req = new XMLHttpRequest();\r\n                req.open(rtyp, url, true);\r\n                req.setRequestHeader('Authorization', 'fmetoken token='+getConfig('token'));\r\n\r\n                if (atyp !== null) {\r\n                    req.setRequestHeader('Accept', atyp);\r\n                }\r\n                if (ctyp !== null && ctyp != 'attachment') {\r\n                    req.setRequestHeader('Content-type', ctyp);\r\n                }\r\n                if (ctyp == 'attachment') {\r\n                    req.setRequestHeader('Content-type', 'application/octet-stream');\r\n                    req.setRequestHeader('Content-Disposition', 'attachment; filename=\"'+params.name+'\"');\r\n                    params = params.contents;\r\n                }\r\n\r\n                req.onreadystatechange = function() {\r\n                    var done = 4;\r\n                    if (req.readyState == done) {\r\n                        var resp;\r\n                        try {\r\n                            resp = req.responseText;\r\n                            if (resp.length === 0 && req.status == 204) {\r\n                                resp = '{ \"delete\" : \"true\" }';\r\n                            } else if (resp.length === 0 && req.status == 202) {\r\n                                resp = '{ \"value\" : \"true\" }';\r\n                            }\r\n                            resp = JSON.parse(resp);\r\n                        } catch (e) {\r\n                            resp = req.response;\r\n                        } finally {\r\n                            callback(resp);\r\n                        }\r\n                    }\r\n                };\r\n                req.send(params);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Build URL from config Method.\r\n     * @param {String} url - URL with placeholders\r\n     * @return {String} url - The result url\r\n     */\r\n    function buildURL(url) {\r\n        url = url.replace(/{{svr}}/g, getConfig('server'));\r\n        url = url.replace(/{{ver}}/g, getConfig('version'));\r\n        return url;\r\n    }\r\n\r\n    // The FME Server Connection Object\r\n    var fme = {\r\n\r\n        /**\r\n         * Initialize the FME Server connection object\r\n         * @param {Object} config - The object holding the configuration\r\n         *      { server : server_url,\r\n         *        token : token_string,\r\n         *        format : json_xml_or_http,\r\n         *        detail : high_or_low,\r\n         *        port : port_number_string,\r\n         *        ssl : true_or_false\r\n         *      }\r\n         * -------------------- OR: LEGACY PARAMETERS BELOW --------------------\r\n         * @param {String} server - Server URL\r\n         * @param {String} token - Obtained from http://yourfmeserver/fmetoken\r\n         * @param {String} format - Output format desired, json (default), xml, or html\r\n         * @param {String} detail - high (default) or low\r\n         * @param {Number} port - Port, default is 80 - string\r\n         * @param {Boolean} ssl - Connect to the server via HTTPS\r\n         */\r\n        init : function(server, token, format, detail, port, ssl) {\r\n            /**\r\n             * Check for the server url and the token parameters - required for connection\r\n             * @return null - if not valid\r\n             */\r\n            if (server === undefined || (typeof server === 'object' && server.server === undefined)) {\r\n                throw new Error('You did not specify a server URL in your configuration parameters.');\r\n            } else if (token === undefined && (typeof server === 'object' && server.token === undefined)) {\r\n                throw new Error('You did not specify a token in your configuration parameters.');\r\n            }\r\n\r\n            /**\r\n             * Check for String paramaters vs. object, and build the configuration\r\n             */\r\n            if (typeof server == 'object') {\r\n                getConfig().server = server.server;\r\n                getConfig().token = server.token;\r\n                getConfig().accept = server.format || 'application/json';\r\n                getConfig().detail =  server.detail || 'high';\r\n                getConfig().port = server.port || '80';\r\n                getConfig().ssl = server.ssl || false;\r\n                getConfig().xdomain = false;\r\n            } else {\r\n                getConfig().server = server;\r\n                getConfig().token = token;\r\n                getConfig().accept = format || 'application/json';\r\n                getConfig().detail =  detail || 'high';\r\n                getConfig().port = port || '80';\r\n                getConfig().ssl = ssl || false;\r\n                getConfig().xdomain = false;\r\n            }\r\n\r\n            /**\r\n             * Remove trailing slash from sever if present\r\n             */\r\n            if (getConfig('server').charAt(getConfig('server').length - 1) == '/') {\r\n                getConfig().server = getConfig('server').substr(0, getConfig('server').length - 1);\r\n            }\r\n\r\n            /**\r\n             * Converts server host to URL\r\n             */\r\n            if (getConfig('server').substring(0, 4) != 'http') {\r\n                getConfig().server = 'http://' + getConfig('server');\r\n            }\r\n\r\n            /**\r\n             * Changes http:// to https:// if SSL is required\r\n             */\r\n            if (getConfig('ssl')) {\r\n                getConfig().server = getConfig('server').replace('http://','https://');\r\n            }\r\n\r\n            /**\r\n             * Set IE8 / IE9 CORS mode if required\r\n             */\r\n            if (location.host != getConfig('server').split('//')[1].split('/')[0] &&\r\n                navigator.appName == 'Microsoft Internet Explorer' &&\r\n                (navigator.appVersion.indexOf('MSIE 9') !== -1 || navigator.appVersion.indexOf('MSIE 8') !== -1)\r\n               )\r\n            {\r\n                getConfig().xdomain = true;\r\n            }\r\n\r\n            /**\r\n             * Attaches port to server URL if not a standard port\r\n             */\r\n            var stdPorts = ['80', '443'];\r\n            if (stdPorts.indexOf(getConfig('port')) === -1) {\r\n                getConfig().server = getConfig('server') + ':' + getConfig('port');\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Gets the current session from FME Server. You can use this to get the path to any\r\n         * files added through the file upload service.\r\n         * @param {String} repository - The repository on the FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {Function} callback - Callback function accepting sessionID as a string\r\n         */\r\n        getSession : function(repository, workspace, callback){\r\n            var min = 1;\r\n            var max = 1000000000;\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmedataupload/' + repository + '/' + workspace);\r\n            var params = 'opt_extractarchive=false&opt_pathlevel=3&opt_fullpath=true&token='\r\n                + getConfig('token')\r\n                + '&opt_namespace='\r\n                + Math.floor(Math.random() * (max - min + 1)) + min;\r\n            ajax(url, callback, 'POST', params, 'application/x-www-form-urlencoded');\r\n        },\r\n\r\n        /**\r\n         * Returns a WebSocket connection to the specified server\r\n         * @param {String} id - A name for the desired WebSocket stream id\r\n         * @param {Function} callback - Callback function to run after connection is opened (optional)\r\n         * @return {WebSocket} ws - A WebSocket connection\r\n         */\r\n        getWebSocketConnection : function(id, callback) {\r\n            callback = callback || null;\r\n            var url;\r\n            if (getConfig('server').indexOf('https://') != -1) {\r\n                url = getConfig('server').replace('https://','wss://');\r\n            } else {\r\n                url = getConfig('server').replace('http://','ws://');\r\n            }\r\n            var ws = new WebSocket(url + ':7078/websocket');\r\n            ws.onopen = function() {\r\n                var openMsg = {\r\n                    ws_op : 'open',\r\n                    ws_stream_id : id\r\n                };\r\n                ws.send(JSON.stringify(openMsg));\r\n                if (callback !== null){\r\n                    callback();\r\n                }\r\n            };\r\n            return ws;\r\n        },\r\n\r\n        /**\r\n         * Runs a workspace using the Data Download service and returns json\r\n         * @param {String} repository - The repository on FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {String} params - Any workspace-specific parameter values as a URL encoded string i.e. param1=value1&param2=value2\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        runDataDownload : function(repository, workspace, params, callback){\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmedatadownload/' + repository + '/' + workspace);\r\n            if (params && params.length > 0) {\r\n                params = '&' + params;\r\n            }\r\n            params = 'opt_responseformat=' + getResponseType() + '&opt_showresult=true&token=' + getConfig('token') + params;\r\n            ajax(url, callback, 'POST', params, 'application/x-www-form-urlencoded');\r\n        },\r\n\r\n        /**\r\n         * Runs a workspace using the Data Streaming service and returns the workspace output\r\n         * @param {String} repository - The repository on FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {String} params - Any workspace-specific parameter values as a URL encoded string i.e. param1=value1&param2=value2\r\n         * @param {Function} callback - Callback function accepting the workspace return value\r\n         */\r\n        runDataStreaming : function(repository, workspace, params, callback){\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmedatastreaming/' + repository + '/' + workspace);\r\n            params = 'opt_showresult=true&token=' + getConfig('token') + '&' + params;\r\n            ajax(url, callback, 'POST', params, 'application/x-www-form-urlencoded');\r\n        },\r\n\r\n        /**\r\n         * Upload file(s) using data upload service\r\n         * @param {String} repository - The repository on FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {Object} files - The form file object\r\n         * @param {String} jsid - The current session id\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        dataUpload : function(repository, workspace, files, jsid, callback) {\r\n            callback = callback || null;\r\n            jsid = jsid || null;\r\n            var url = buildURL('{{svr}}/fmedataupload/' + repository + '/' + workspace);\r\n            var token = getConfig('token');\r\n            if(jsid !== null) {\r\n                url += '?opt_namespace=' + jsid;\r\n                url += '&opt_fullpath=true';\r\n                url += '&token=' + token;\r\n            } else {\r\n                url += '?token=' + token;\r\n                url += '&opt_fullpath=true';\r\n            }\r\n            if(!FormData) { // IE9 and Older Browsers that don't support FormData\r\n\r\n                // Random number for form and frame id\r\n                var random = parseInt(Math.random() * 100000000);\r\n\r\n                // Create the invisible iframe for the form target\r\n                var iframe = document.createElement('iframe');\r\n                iframe.id = random + '-frame';\r\n                iframe.name = random;\r\n                iframe.style.display = 'none';\r\n                document.body.appendChild(iframe);\r\n\r\n                // Create the form with the proper settings and set the target to the iframe\r\n                var form = document.createElement('form');\r\n                form.action = url;\r\n                form.method = 'POST';\r\n                form.enctype = 'multipart/form-data';\r\n\r\n                // Clone the file input and set it's files\r\n                var input = files.cloneNode(true);\r\n                input.name = \"files[]\";\r\n                input.files = files.files;\r\n                form.appendChild(input);\r\n\r\n                // Finish styling and submit the form\r\n                form.target = random;\r\n                form.id = random + '-form';\r\n                form.style.display = 'none';\r\n                document.body.appendChild(form);\r\n                form.submit();\r\n\r\n                // Send feedback for client methods\r\n                callback({ submit : true, id : random });\r\n\r\n            } else { // New HTML5 Method for browsers that support FormData\r\n\r\n                // Chrome 7+, Firefox 4.0 (2.0), IE 10+, Opera 12+, Safari 5+\r\n                var params = new FormData();\r\n\r\n                // Loop through, support for multiple files\r\n                for(var i = 0; i < files.files.length; i++) {\r\n                    params.append('files[]', files.files[i]);\r\n                }\r\n                url = url;\r\n                ajax(url, callback, 'POST', params);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Get data upload files for the session\r\n         * @param {String} repository - The repository on FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {String} jsid - The current session id\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getDataUploads : function(repository, workspace, jsid, callback) {\r\n            callback = callback || null;\r\n            jsid = jsid || null;\r\n            var url = buildURL('{{svr}}/fmedataupload/' + repository + '/' + workspace);\r\n            if (jsid !== null){\r\n                url += '?opt_namespace=' + jsid;\r\n                url += '&opt_fullpath=true';\r\n            }\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Runs a workspace with user uploaded session data\r\n         * @param {String} repository - The repository on FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {Object} params - The parameter object for running the workspace structured as json\r\n         *  It should contain the following attributes:\r\n\t\t\t\tfilename -> name of the source dataset parameter - it assumes there's only one\r\n\t\t\t\tfiles -> a list of file paths to point the source dataset at\r\n\t\t\t\t\t\tdefined like: files = [{path : \"mypath\\filename.txt\"}, {path : \"mysecondpath\\filename.txt\"}]\r\n\t\t\t\t\t\tcan come directly from the response from uploadFile or getDataUploads\r\n                service -> the service with which to run the workspace (datadownload, jobsubmitter, etc)\r\n                params -> (optional) extra parameters to set in the workspace (set as \"PARAMETERNAME=VALUE&OTHERPARAM=OTHERVALUE\")\r\n            i.e. it can be defined as:\r\n                var params = {\r\n                    filename : 'SourceDataset_GENERIC',\r\n                    files : uploadedFiles,\r\n                    service : 'fmejobsubmitter',\r\n                    params : \"DestinationFormat=OGCKML\"\r\n                }\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        runWorkspaceWithData : function(repository, workspace, params, callback) {\r\n            callback = callback || null;\r\n            var service = params.service || 'fmedatadownload';\r\n            var url = buildURL('{{svr}}/' + service + '/' + repository + '/' + workspace + '?');\r\n            var files = params.files;\r\n            var extra = params.params;\r\n            params = params.filename + '=%22%22';\r\n            for(var f in files){\r\n                params += files[f].path + '%22%20%22';\r\n            }\r\n            if(extra){params += '&' + extra};\r\n            params += '&opt_responseformat=' + getResponseType() + '&token=' + getConfig('token');\r\n            ajax(url+params, callback);\r\n        },\r\n\r\n        /**\r\n         * Retrieves all available Repositories on the FME Server\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getRepositories : function(callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/repositories');\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Retrieves all items on the FME Server for a given Repository\r\n         * @param {String} repository - The repository on FME Server\r\n         * @param {String} type - The specific type of file item requested (optional)\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getRepositoryItems : function(repository, callback, type) {\r\n            type = type || '';\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/repositories/' + repository + '/items?type=' + type);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Retrieves all published parameters for a given workspace\r\n         * @param {String} repository - The repository on FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getWorkspaceParameters : function(repository, workspace, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/repositories/' + repository + '/items/' + workspace + '/parameters');\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Retrieves a single published parameter for a given workspace\r\n         * @param {String} repository - The repository the FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {String} parameter - The name of the workspace parameter\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        queryWorkspaceParameter : function(repository, workspace, parameter, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/repositories/' + repository + '/items/' + workspace + '/parameters/' + parameter);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Generates a standard workspace parameters form\r\n         * @param {String} id - The container id in which to place the form elements\r\n         * @param {Object} json - The json object representing the form parameters (can come directly from getWorkspaceParameters)\r\n         * @param {Array} items - (Optional) The array of parameter names you wish to expose, by default all parameters are exposed\r\n         */\r\n        generateFormItems : function(id, json, items) {\r\n            var form = document.getElementById(id);\r\n            //if a single parameter is sent as json, add it into an array first\r\n            if (typeof json.length == 'undefined'){json = [json];}\r\n            // Loop through the JSON object and build the form\r\n            for(var i = 0; i < json.length; i++) {\r\n                var param = json[i];\r\n                if (!items || items.indexOf(param.name) !== -1) {\r\n                    var span = document.createElement(\"span\");\r\n                    span.setAttribute(\"class\", param.name + \" fmes-form-component\");\r\n                    var label = document.createElement(\"label\");\r\n                    label.innerHTML = param.description;\r\n                    span.appendChild(label);\r\n                    var choice;\r\n                    if(param.type === \"FILE_OR_URL\" || param.type === \"FILENAME_MUSTEXIST\" || param.type === \"FILENAME\") {\r\n                        choice = document.createElement(\"input\");\r\n                        choice.type = \"file\";\r\n                        choice.name = param.name;\r\n                    } else if(param.type === \"LISTBOX\" || param.type === \"LOOKUP_LISTBOX\") {\r\n                        choice = document.createElement(\"div\");\r\n                        var options = param.listOptions;\r\n                        for(var a = 0; a < options.length; a++) {\r\n                            var option = options[a];\r\n                            var checkbox = document.createElement(\"input\");\r\n                            checkbox.type = \"checkbox\";\r\n                            checkbox.value = option.value;\r\n                            checkbox.name = param.name;\r\n                            choice.appendChild(checkbox);\r\n                            var caption = document.createElement(\"label\");\r\n                            caption.innerHTML = option.caption;\r\n                            choice.appendChild(caption);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (checkbox.value == param.defaultValue) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcheckbox.checked = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n                        }\r\n                    } else if(param.type === \"LOOKUP_CHOICE\" ||\r\n                              param.type === \"STRING_OR_CHOICE\" ||\r\n                              param.type === \"CHOICE\")\r\n                    {\r\n                        choice = document.createElement(\"select\");\r\n                        choice.name = param.name;\r\n                        var options = param.listOptions;\r\n                        for(var a = 0; a < options.length; a++) {\r\n                            var option = options[a];\r\n                            var optionItem = document.createElement(\"option\");\r\n                            optionItem.innerHTML = option.caption;\r\n                            optionItem.value = option.value;\r\n                            choice.appendChild(optionItem);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (optionItem.value == param.defaultValue) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\toptionItem.selected = true;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n                        }\r\n                    } else if(param.type  === \"TEXT_EDIT\") {\r\n                        choice = document.createElement(\"textarea\");\r\n                        choice.name = param.name;\r\n\t\t\t\t\t\t\t\t\t\t\t\tchoice.value = param.defaultValue;\r\n                    } else if(param.type  == \"INTEGER\") {\r\n                        choice = document.createElement(\"input\");\r\n                        choice.type = \"number\";\r\n                        choice.name = param.name;\r\n\t\t\t\t\t\t\t\t\t\t\t\tchoice.value = param.defaultValue;\r\n                    } else if(param.type  == \"PASSWORD\") {\r\n                        choice = document.createElement(\"input\");\r\n                        choice.type = \"password\";\r\n                        choice.name = param.name;\r\n                    } else {\r\n                        choice = document.createElement(\"input\");\r\n                        choice.value = param.defaultValue;\r\n                        choice.name = param.name;\r\n                    }\r\n\r\n                    span.appendChild(choice);\r\n                    form.appendChild(span);\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Retrieves all scheduled items\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getSchedules : function(callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/schedules');\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Returns a scheduled item\r\n         * @param {String} category - Schedule category title\r\n         * @param {String} name - Schedule name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getScheduleItem : function(category, item, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/schedules/' + category + '/' + item);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Replaces a scheduled item\r\n         * @param {String} category - Schedule category title\r\n         * @param {String} item - Schedule name\r\n         * @param {Object} schedule - Object holding the schedule information\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        replaceScheduleItem : function(category, item, schedule, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/schedules/' + category + '/' + item);\r\n            var params = JSON.stringify(schedule);\r\n            ajax(url, callback, 'PUT', params, 'application/json');\r\n        },\r\n\r\n        /**\r\n         * Remove a scheduled item\r\n         * @param {String} category - Schedule category title\r\n         * @param {String} item - Schedule name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        removeScheduleItem : function(category, item, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/schedules/' + category + '/' + item);\r\n            ajax(url, callback, 'DELETE');\r\n        },\r\n\r\n        /**\r\n         * Create a scheduled item\r\n         * @param {Object} schedule - Json object holding the schedule information\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        createScheduleItem : function(schedule, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/schedules');\r\n            var params = JSON.stringify(schedule);\r\n            ajax(url, callback, 'POST', params, 'application/json');\r\n        },\r\n\r\n        /**\r\n         * Get all publications\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getAllPublications : function(callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/publications');\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Get a publication\r\n         * @param {String} name - Publication name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getPublication : function(name, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/publications/' + name);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Create a publication\r\n         * @param {Object} publication - Object holding the publication information\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        createPublication : function(publication, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/publications');\r\n            var params = JSON.stringify(publication);\r\n            ajax(url, callback, 'POST', params, 'application/json');\r\n        },\r\n\r\n        /**\r\n         * Update a publication\r\n         * @param {String} name - Publication name\r\n         * @param {Object} publication - Object holding the publication information\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        updatePublication : function(name, publication, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/publications/' + name);\r\n            var params = JSON.stringify(publication);\r\n            ajax(url, callback, 'PUT', params, 'application/json');\r\n        },\r\n\r\n        /**\r\n         * Delete a publication\r\n         * @param {String} name - Publication name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        deletePublication : function(name, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/publications/' + name);\r\n            ajax(url, callback, 'DELETE');\r\n        },\r\n\r\n        /**\r\n         * Get Publisher Protocols\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getPublisherProtocols : function(callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/publishers/');\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Query Publisher Protocol\r\n         * @param {String} name - Protocol name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        queryPublisherProtocol : function(name, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/publishers/' + name);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Get all subscriptions\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getAllSubscriptions : function(callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/subscriptions');\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Get a subscription\r\n         * @param {String} name - Subscription name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getSubscription : function(name, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/subscriptions/' + name);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Create a subscription\r\n         * @param {Object} subscription - Object holding the subscription information\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        createSubscription : function(subscription, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/subscriptions');\r\n            var params = JSON.stringify(subscription);\r\n            ajax(url, callback, 'POST', params, 'application/json');\r\n        },\r\n\r\n        /**\r\n         * Update a subscription\r\n         * @param {String} name - Subscription name\r\n         * @param {Object} subscription - Object holding the subscription information\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        updateSubscription : function(name, subscription, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/subscriptions/' + name);\r\n            console.log(url);\r\n            var params = JSON.stringify(subscription);\r\n            ajax(url, callback, 'PUT', params, 'application/json');\r\n        },\r\n\r\n        /**\r\n         * Delete a subscription\r\n         * @param {String} name - Subscription name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        deleteSubscription : function(name, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/subscriptions/' + name);\r\n            ajax(url, callback, 'DELETE');\r\n        },\r\n\r\n        /**\r\n         * Get Subscriber Protocols\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getSubscriberProtocols : function(callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/subscribers/');\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Query Subscriber Protocol\r\n         * @param {String} name - Protocol name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        querySubscriberProtocol : function(name, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/subscribers/' + name);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Get Notification Topics\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getNotificationTopics : function(callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/topics');\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Get Notification Topic\r\n         * @param {String} name - Topic name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getNotificationTopic : function(name, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/topics/' + name);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Create Topic\r\n         * @param {String} name - Topic name\r\n         * @param {String} description - Topic description\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        createTopic : function(name, description, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name).replace(/%20/g, '+');\r\n            description = encodeURIComponent(description).replace(/%20/g, '+');\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/topics');\r\n            var params = \"name=\" + name + \"&description=\" + description;\r\n            ajax(url, callback, 'POST', params, 'application/x-www-form-urlencoded');\r\n        },\r\n\r\n        /**\r\n         * Update Topic Description\r\n         * @param {String} name - Topic name\r\n         * @param {String} description - Topic description\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        updateTopic : function(name, description, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            description = encodeURIComponent(description).replace(/%20/g, '+');\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/topics/' + name);\r\n            var params = \"description=\" + description;\r\n            ajax(url, callback, 'PUT', params, 'application/x-www-form-urlencoded');\r\n        },\r\n\r\n        /**\r\n         * Delete Topic\r\n         * @param {String} name Topic name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        deleteTopic : function(name, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/topics/' + name);\r\n            ajax(url, callback, 'DELETE');\r\n        },\r\n\r\n        /**\r\n         * Publish JSON to a topic\r\n         * @param {String} name - Topic name\r\n         * @param {String} message - The data as a json string\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        publishToTopicStructured : function(name, message, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/topics/' + name + '/message');\r\n            var type = 'application/json';\r\n            try {\r\n                message = JSON.parse(message);\r\n                message = JSON.stringify(message);\r\n            } catch(e) {\r\n                var response = { response : 'Unable to parse JSON' };\r\n                callback(response);\r\n                return false;\r\n            }\r\n            ajax(url, callback, 'POST', message, type);\r\n        },\r\n\r\n        /**\r\n         * Publish anything to a topic\r\n         * @param {String} name - Topic name\r\n         * @param {Object} or {String} message - The raw text data\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        publishToTopic : function(name, message, callback) {\r\n            callback = callback || null;\r\n            name = encodeURIComponent(name);\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/notifications/topics/' + name + '/message/subscribercontent');\r\n            ajax(url, callback, 'POST', message, '*/*');\r\n        },\r\n\r\n        /**\r\n         * Lookup user token\r\n         * @param {String} user - The username for the required level of access\r\n         * @param {String} password - The password that belongs to that user\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        lookupToken : function(user, password, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmetoken/service/view.json');\r\n            var params = 'user=' + user + '&password=' + password;\r\n            ajax(url, callback, 'POST', params, 'application/x-www-form-urlencoded');\r\n        },\r\n\r\n        /**\r\n         * Generate guest token\r\n         * @param {String} user - The username for the required level of access\r\n         * @param {String} password - The password that belongs to that user\r\n         * @param {Integer} count - The number of seconds, minutes, hours, or days for the token to last\r\n         * @param {String} unit - Unit of time for the token to last (can be second, minute, hour, or day)\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        generateToken : function(user, password, count, unit, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmetoken/service/generate');\r\n            var params = 'user=' + user + '&password=' + password + '&expiration=' + count + '&timeunit=' + unit;\r\n            ajax(url, callback, 'POST', params, 'application/x-www-form-urlencoded');\r\n        },\r\n\r\n        /**\r\n         * Submit a Job to Run asynchronously\r\n         * @param {String} repository - The repository on the FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {String} params - Any workspace-specific parameter values as json\r\n         *  i.e. can be defined like:\r\n         *  var parameters = {'publishedParameters' : [\r\n\t\t\t\t\t\t\t\t{'name': 'MAXY', 'value':'42'},\r\n                                {'name':'THEMES','value':['airports', 'cenart']}]\r\n                            }\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        submitJob : function(repository, workspace, params, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/transformations/submit/' + repository + '/' + workspace);\r\n            params = JSON.stringify(params);\r\n            ajax(url, callback, 'POST', params, 'application/json');\r\n        },\r\n\r\n        /**\r\n         * Submit a Job to Run Synchronously\r\n         * @param {String} repository - The repository on the FME Server\r\n         * @param {String} workspace - The name of the workspace on FME Server, i.e. workspace.fmw\r\n         * @param {String} params - Any workspace-specific parameter values as json\r\n         * i.e. can be defined like:\r\n         *  var parameters = {'publishedParameters' : [\r\n\t\t\t\t\t\t\t\t{'name': 'MAXY', 'value':'42'},\r\n                                {'name':'THEMES','value':['airports', 'cenart']}]\r\n                            }\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        submitSyncJob : function(repository, workspace, params, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/transformations/transact/' + repository + '/' + workspace);\r\n            params = JSON.stringify(params);\r\n            ajax(url, callback, 'POST', params, 'application/json');\r\n        },\r\n\r\n        /**\r\n         * Get a List of All Shared Resource Connections\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getResources : function(callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/resources/connections');\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Get Resource Connection details\r\n         * @param {String} resource - The resource name\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getResourceDetails : function(resource, callback) {\r\n            callback = callback || null;\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/resources/connections/' + resource);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Get the metadata for a directory or regular file inside a Resource Connection\r\n         * @param {String} resource - The resource name\r\n         * @param {String} path - The folder or file path within the resource on FME Server\r\n         * @param {String} depth - The number of directory levels deep from which to retrieve metadata\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        getResourceContents : function(resource, path, depth, callback) {\r\n            callback = callback || null;\r\n            path = path || '/';\r\n            path = encodeURIComponent(path).replace(/%2F/g, '/');\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/resources/connections/' + resource + '/filesys' + path + '?depth=' + depth);\r\n            ajax(url, callback);\r\n        },\r\n\r\n        /**\r\n         * Delete Resource File\r\n         * @param {String} resource - The resource name\r\n         * @param {String} path - The file path within the resource on the server\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         */\r\n        deleteResource : function(resource, path, callback) {\r\n            callback = callback || null;\r\n            path = encodeURIComponent(path).replace(/%2F/g, '/');\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/resources/connections/' + resource + '/filesys' + path);\r\n            ajax(url, callback, 'DELETE');\r\n        },\r\n\r\n        /**\r\n         * Download Resource File\r\n         * @param {String} resource - The resource name\r\n         * @param {String} path - The resource file path on the server\r\n         */\r\n        downloadResourceFile : function(resource, path) {\r\n            path = encodeURIComponent(path).replace(/%2F/g, '/');\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/resources/connections/' + resource + '/filesys' + path + '?accept=contents');\r\n            var iframe = document.createElement('iframe');\r\n            iframe.style.display = 'none';\r\n            document.body.appendChild(iframe);\r\n            iframe.src = url + '&token=' + getConfig('token');\r\n        },\r\n\r\n        /**\r\n         * Upload Resource File\r\n         * @param {String} resource - The resource name\r\n         * @param {String} path - The file path within the resource on the server\r\n         * @param {Object} files - The form file object\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         * @param {Boolean} overwrite - Overwrite files, true or false(default)\r\n         * @param {Boolean} createFolders - Create folders from path, true or false(default)\r\n         */\r\n        uploadResourceFile : function(resource, path, files, callback, overwrite, createFolders) {\r\n            callback = callback || null;\r\n            overwrite = overwrite || false;\r\n            createFolders = createFolders || false;\r\n            path = encodeURIComponent(path).replace(/%2F/g, '/');\r\n            var url = buildURL('{{svr}}/fmerest/{{ver}}/resources/connections/' + resource + '/filesys' + path);\r\n            url = url + '?createDirectories=' + createFolders + '&overwrite=' + overwrite + '&type=FILE';\r\n\r\n            var params = new FormData();\r\n\r\n            // Loop through, support for multiple files\r\n            for(var i = 0; i < files.files.length; i++) {\r\n                params.append('files[]', files.files[i]);\r\n            }\r\n\r\n            url = url;\r\n            ajax(url, callback, 'POST', params);\r\n        },\r\n\r\n        /**\r\n         * Submit a custom REST request directly to the API\r\n         * @param {String} url - Full url of the REST call including the server\r\n         * @param {String} type - The request type, i.e. GET, POST, PUSH, ...\r\n         * @param {Function} callback - Callback function accepting the json return value\r\n         * @param {String} params - Any parameter values required by the API (Optional)\r\n         * @param {String} ctyp - The Content type of the data being sent, ex: 'application/json'\r\n         */\r\n        customRequest : function(url, type, callback, params, ctyp) {\r\n            callback = callback || null;\r\n            params = params || null;\r\n            type = type.toUpperCase();\r\n            ctyp = ctyp || null;\r\n            ajax(url, callback, type, params, ctyp);\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n     * Return the constructed FMEServer Connection Object\r\n     */\r\n    return fme;\r\n}());\r\n\r\n\r\n"]}]}